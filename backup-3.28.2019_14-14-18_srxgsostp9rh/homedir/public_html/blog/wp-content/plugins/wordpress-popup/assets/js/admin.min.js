!function(e){"use strict";var l,d,r,i,s,t,o,n,a;window.Hustle=(l=jQuery,d=document,r=window,i={},s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},t=_.extend({},Backbone.Events),o=Backbone.View.extend({__base_events:{"click .wph-tabs--wrap .wph-tabs--nav li label":"__base_toggle_tab"},initialize:function(){this.events=_.extend({},this.events,this.__base_events),_.isFunction(this.init_mix)&&this.init_mix.apply(this,arguments),this.render&&(this.render=_.wrap(this.render,function(e){this.trigger("before_render"),e.call(this),t.trigger("view.rendered",this),this.trigger("rendered")})),_.isFunction(this.init)&&this.init.apply(this,arguments)},__base_toggle_tab:function(e){var t=this.$(e.target),i=(t.attr("href")||"").replace(/^\#/,""),s=!!i&&this.$("#"+i),o=t.closest(".wph-tabs--wrap"),n=t.closest("li");s&&s.length&&(o.find(".wph-tabs--content").not(s).removeClass("current"),s.addClass("current"),n.addClass("current"),n.siblings().removeClass("current"))}}),n=_.memoize(function(t){var i;return function(e){return(i=i||_.template(document.getElementById(t).innerHTML,null,s))(e).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),a=_.memoize(function(t){var i;return function(e){return(i=i||_.template(t,null,s))(e)}}),{define:function(e,n){if(e.split(".").length){var a=function(e,t){var i=e.split("."),s=i.splice(0,1)[0];if(s){if(i.length)t[s]=t[s]||{};else{var o=n.call(null,l,d,r);t[s]=_.isFunction(o)||void 0===o?o:_.extend(t[s]||{},o)}i.length&&s&&a(i.join("."),t[s])}};a(e,i)}else{var t=i[e]||{};i[e]=_.extend(t,n.call(null,l,d,r))}},get_modules:function(){return i},get:function(e){if(e.split(".").length){var o=!1,n=function(e,t){var i=e.split("."),s=i.splice(0,1)[0];o=t[s],i.length&&n(i.join("."),t[s])};return n(e,i),o}return i[e]||!1},Events:t,View:o,template:n,create_template:a,get_template_options:function(){return l.extend(!0,{},s)},cookie:{set:function(e,t,i){var s,o;t=l.isArray(t)||l.isPlainObject(t)?JSON.stringify(t):t,isNaN(i)?o="":((s=new Date).setTime(s.getTime()+24*i*60*60*1e3),o="; expires="+s.toGMTString()),document.cookie=e+"="+t+o+"; path=/"},get:function(e){var t,i,s,o=document.cookie.split(";");for(s=e+"=",t=0;t<o.length;t+=1){for(i=o[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(s)){var n=i.substring(s.length,i.length);return n?JSON.parse(n):n}}return null}},consts:{Module_Show_Count:"hustle_module_show_count-"}})}(jQuery);var Optin=Optin||{};Optin.View={},Optin.Models={},Optin.Events={},"undefined"!=typeof Backbone&&_.extend(Optin.Events,Backbone.Events),function(o){"use strict";Optin.COOKIE_PREFIX="inc_optin_long_hidden-",Optin.POPUP_COOKIE_PREFIX="inc_optin_popup_long_hidden-",Optin.SLIDE_IN_COOKIE_PREFIX="inc_optin_slide_in_long_hidden-",Optin.SLIDE_IN_COOKIE_HIDE_ALL="inc_optin_slide_in_hide_all",Optin.EMBEDDED_COOKIE_PREFIX="inc_optin_embedded_long_hidden-",Optin.global_mixin=function(){_.mixin({log:function(){console.log(arguments)},toBool:function(e){return _.isBoolean(e)?e:_.isString(e)&&-1!==["true","false","1"].indexOf(e.toLowerCase())?"true"===e.toLowerCase()||"1"===e.toLowerCase():_.isNumber(e)?!!e:!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&e},isTrue:function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&(_.isNumber(e)?0!==e:(e=e.toString().toLowerCase(),-1!==["1","true","on"].indexOf(e)))},isFalse:function(e){return!_.isTrue(e)},control_base:function(e,t,i){return i=_.isUndefined(i)?"checked":i,e=_.toBool(e),t=_.isBoolean(e)?_.isTrue(t):t,_.isEqual(e,t)?i+"="+i:""},checked:function(e,t){return _.control_base(e,t,"checked")},selected:function(e,t){return _.control_base(e,t,"selected")},disabled:function(e,t){return _.control_base(e,t,"disabled")},class:function(e,t,i){return _.isTrue(e)?t:void 0!==i?i:""},add_class:function(e,t,i){return"class={class}".replace("{class}",_.class(e,t,i))},toUpperCase:function(e){return _.isString(e)?e.toUpperCase():""}}),_.findKey||_.mixin({findKey:function(e,t,i){t=cb(t,i);for(var s,o=_.keys(e),n=0,a=o.length;n<a;n++)if(t(e[s=o[n]],s,e))return s}})},Optin.global_mixin(),Backbone.Model.prototype.toJSON=function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||Backbone.Collection&&e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.isEmpty=function(){return 0===this.length||!this.trim()},Optin.template=_.memoize(function(t){var i,s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(e){return(i=i||_.template(o("#"+t).html(),null,s))(e).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.template_compat=_.memoize(function(t){var i;return function(e){return(i=i||_.template(o("#"+t).html()))(e).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.cookie=Hustle.cookie,o(document).on("blur","input, textarea, select",function(){var e=o(this);e.is(":input[type=button], :input[type=submit], :input[type=reset]")||(e.val()&&e.val().trim&&""!==e.val().trim()?e.parent().addClass("hustle-input-filled"):e.parent().removeClass("hustle-input-filled"))}),Optin.Mixins={_mixins:{},_services_mixins:{},_desing_mixins:{},_display_mixins:{},add:function(e,t){this._mixins[e]=t},get_mixins:function(){return this._mixins},add_services_mixin:function(e,t){this._services_mixins[e]=t},get_services_mixins:function(){return this._services_mixins}}}(jQuery),Hustle.define("Modal_Email",function(n){"use strict";var t={};return Backbone.View.extend({id:"wph-modal-email",className:"wpmudev-modal",template:Optin.template("hustle-modal-email-tpl"),list_header_template:Optin.template("wpoi-email-list-header-tpl"),list_template:Optin.template("wpoi-emails-list-tpl"),show_delay:350,events:{"click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(){return this.render()},render:function(){var o=this,e=this.template(this.model);return e=(e=e.replace("__id",this.model.id)).replace("__type",this.model.type),this.$el.html(e),t[this.model.id]||(t[this.model.id]=n.ajax({url:ajaxurl,type:"GET",data:{action:"hustle_get_email_lists",id:o.model.id,_ajax_nonce:n("#hustle_get_emails_list_nonce").val()}}),this.delay_show=0),t[this.model.id].then(function(e){if(e.success){var t=e.data.module_fields,i=[];o.model.module_fields.length||(o.model.module_fields=t,o.$(".wpmudev-listing-head").html(o.list_header_template({module_fields:t})),_.each(t,function(e){i.push({name:e.name,label:e.label})}));var s=o.list_template({subscriptions:e.data.subscriptions,module_fields:i});o.$(".wpmudev-listing-body").html(s)}}),this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){n("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},close:function(e){e.preventDefault(),this.$el.removeClass("show"),_.delay(function(){this.remove()}.bind(this),350)},hide:function(e){var t=n(e.target),i=this.$el.find(".wpmudev-box-modal"),s=this;(t.hasClass("wpmudev-modal-mask")||t.hasClass("wpmudev-i_close")||t.parent().hasClass("wpmudev-i_close"))&&(i.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){s.$el.removeClass("wpmudev-modal-active"),n("body").removeClass("wpmudev-modal-is_active"),i.removeClass("wpmudev-hide")},500))}})}),Hustle.define("Modal_Error",function(o){"use strict";var s=Backbone.View.extend({template:Optin.template("hustle-error-list-tpl"),className:"wpmudev-listing-row",controller:!1,initialize:function(e){this.controller=e.controller,this.module_fields=e.module_fields,this.render()},render:function(){var e=this.template({model:this.model,module_fields:this.module_fields});this.$el.html(e),this.$el.appendTo(this.controller.$(".wpmudev-listing-body"))}});return Backbone.View.extend({id:"wph-modal-error",template:Optin.template("hustle-modal-error-tpl"),list_header_template:Optin.template("hustle-error-header-list-tpl"),className:"wpmudev-modal",events:{"click .inc-opt-close-error-list":"toggleErrorLog","click .wpmudev-button-clear-logs":"clearLogs","click .wpmudev-button-delete-logs":"_clean","click .wpmudev-button-cancel-delete-logs":"cancelDelete","click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(e){return this.$el.html(this.template({id:this.model.id})),this.button=e.button,this.render()},render:function(){var i=this,e=this.template(this.model);return e=(e=e.replace("__id",this.model.id)).replace("__type",this.model.type),this.clearLogButton=this.$(".wpmudev-button-clear-logs"),this.exportButton=this.$(".wpmudev-button-download-csv"),this.deleteConfirmation=this.$(".hustle-delete-logs-confirmation"),o.getJSON(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.error_log_nonce,action:"get_error_list"},function(e){if(e.success&&e.data&&e.data.logs){var t=e.data.module_fields;i.model.module_fields=t,i.$(".wpmudev-listing-head").html(i.list_header_template({module_fields:t})),_.each(e.data.logs,function(e){new s({module_fields:t,model:e,controller:i})}),i.show()}}),this.$el.html(e),0<o("#wph-modal-error").length?o("#wph-modal-error").html(this.$el):this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){o("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},hide:function(e){var t=o(e.target),i=this.$el.find(".wpmudev-box-modal"),s=this;(t.hasClass("wpmudev-modal-mask")||t.hasClass("wpmudev-i_close")||t.parent().hasClass("wpmudev-i_close"))&&(i.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){s.$el.removeClass("wpmudev-modal-active"),o("body").removeClass("wpmudev-modal-is_active"),i.removeClass("wpmudev-hide")},500))},toggleErrorLog:function(){this.$el.removeClass("show")},clearLogs:function(e){o(e.target).parents(".wpmudev-footer-clear").find(".hustle-delete-logs-confirmation").removeClass("wpmudev-hidden"),this.clearLogButton.attr("disabled",!0),this.exportButton.attr("disabled",!0)},_clean:function(){var t=this;o.get(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.clear_log_nonce,action:"clear_logs"},function(e){e.success&&(t.toggleErrorLog(),_.delay(function(){t.button.remove(),t.remove()},350))})},cancelDelete:function(e){o(e.target).parents(".hustle-delete-logs-confirmation").addClass("wpmudev-hidden"),this.clearLogButton.removeAttr("disabled"),this.exportButton.removeAttr("disabled")}})}),Hustle.define("Modal_Import",function(o){"use strict";return Backbone.View.extend({id:"wph-modal-import",className:"wpmudev-modal",template:Optin.template("hustle-modal-import-tpl"),show_delay:350,events:{"click .wpmudev-button-confirm-import":"import","click .wpmudev-button-cancel-import":"cancelImport","click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide","click #wpmudev-button-import":"preImport"},initialize:function(){return this.render()},render:function(){var e=this.template(this.model);return this.importButton=this.$("#wpmudev-button-import"),this.$el.html(e),this.$el.appendTo("#wpmudev-hustle"),this.show(),this},cancelImport:function(e){o(e.target).parents(".hustle-confirmation").addClass("wpmudev-hidden"),this.importButton.prop("disabled",!1)},preImport:function(e){o("#wph-optin-service-import-form input").val()&&(o(e.target).parents(".wpmudev-box-footer").find(".hustle-confirmation").removeClass("wpmudev-hidden"),this.importButton.prop("disabled",!0))},import:function(e){var t,i=o(e.target),s=o("#wph-optin-service-import-form input[type=file]").get(0).files[0];(t=new FormData).append("action","hustle_import_module"),t.append("id",i.data("id")),t.append("type",i.data("type")),t.append("_ajax_nonce",i.data("nonce")),t.append("file",s),o.ajax({url:ajaxurl,type:"POST",data:t,cache:!1,processData:!1,contentType:!1,success:function(e){e.success?location.reload():(o("#import_error").html(o("<label><span>"+e.data+"</span></label>").prop({class:"wpmudev-label--notice"})),o("#import_error label").delay(5e3).fadeOut("slow",function(){o(this).remove()}))}})},show:function(){o("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},hide:function(e){var t=o(e.target),i=this.$el.find(".wpmudev-box-modal"),s=this;(t.hasClass("wpmudev-modal-mask")||t.hasClass("wpmudev-i_close")||t.parent().hasClass("wpmudev-i_close"))&&(i.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){s.$el.removeClass("wpmudev-modal-active"),o("body").removeClass("wpmudev-modal-is_active"),i.removeClass("wpmudev-hide")},500))}})}),function(a){"use strict";Hustle.Events.on("modules.view.rendered",function(n){Hustle.Events.trigger("modules.view.select.render",n),n instanceof Backbone.View&&(a(".wpmudev-box-close").each(function(){var e=a(this),t=e.find(".wpmudev-box-action"),i=e.find(".wpmudev-box-body");t.on("click",function(e){e.stopPropagation(),i.slideToggle()})}),a(".wpmudev-box-close").each(function(){var t=a(this);t.find(".wpmudev-i_close").on("click",function(e){e.stopPropagation(),t.removeClass("wpmudev-show").addClass("wpmudev-hide")})}),function(){function e(){var e=a(window).scrollTop(),t=a(".wpmudev-preview-anchor");t.length&&((t=t.offset().top)<e?(a(".wpmudev-menu").addClass("wpmudev-preview-on"),a(".wpmudev-preview").addClass("wpmudev-preview-sticky"),a(".wpmudev-preview-anchor").height(a(".wpmudev-preview").outerHeight())):(a(".wpmudev-menu").removeClass("wpmudev-preview-on"),a(".wpmudev-preview").removeClass("wpmudev-preview-sticky"),a(".wpmudev-preview-anchor").height(0)))}a(function(){a(window).scroll(e),e()})}(),a("#wph-add-new-service-modal").each(function(){var t=a(this),e=(a("#wph-add-another-service"),t.find(".wpmudev-i_close")),i=t.find("#wph-cancel-add-service"),s=t.find(".wpmudev-box-modal");e.on("click",function(e){e.stopPropagation(),s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),a("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},1e3)}),i.on("click",function(e){e.preventDefault(),e.stopPropagation(),s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),a("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},1e3)})}),a("input#group_instructions").each(function(){a(this).val('<label class="wpmudev-label--notice">'+skbl+"</label>")}),a("#wph-edit-form-modal").each(function(){var t=a(this),e=(a("#wph-edit-form"),t.find(".wpmudev-i_close")),i=t.find("#wph-cancel-edit-form"),s=t.find(".wpmudev-box-modal");e.on("click",function(e){e.stopPropagation(),s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),a("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},1e3)}),i.on("click",function(e){e.preventDefault(),e.stopPropagation(),s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),a("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},1e3)})}),a("#wph-preview-modal").each(function(){var e=a(this),t=(a(".wpmudev-preview"),e.find(".hustle-modal"),e.find(".hustle-modal-success")),i=(e.find(".hustle-modal-close .hustle-icon"),e.find(".hustle-modal-cta")),s=e.find("a"),o=e.find("button");i.on("click",function(e){e.preventDefault()}),s.on("click",function(e){e.preventDefault()}),t.length?o.on("click",function(e){e.preventDefault(),t.addClass("hustle-modal-success_show"),Hustle.Events.trigger("modules.view.preview.success",n)}):o.on("click",function(e){e.preventDefault()})}),a(".wpmudev-table-body-row").each(function(){var t=a(this);t.find(".wpmudev-preview-item-manage").click(function(e){e.stopPropagation(),t.toggleClass("wpmudev-open")})}),a(".hustle-modal-three .hustle-modal-optin_form").each(function(){var e=a(this),t=e.find(".hustle-modal-optin_field"),i=a('<div class="hustle-modal-optin_half" />'),s=t.length;if(e.hasClass("hustle-modal-optin_groups")){e.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var o=0;o<s;o+=2)t.filter(":eq("+o+"),:eq("+(o+1)+")").wrapAll(i)}}),a(".hustle-modal-four .hustle-modal-optin_form").each(function(){var e=a(this),t=e.find(".hustle-modal-optin_field"),i=a('<div class="hustle-modal-optin_half" />'),s=t.length;if(e.hasClass("hustle-modal-optin_groups")){e.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var o=0;o<s;o+=2)t.filter(":eq("+o+"),:eq("+(o+1)+")").wrapAll(i)}}),console.log("view rendered"))});var e={allowClear:!1,containerCssClass:"wpmudev-select2",dropdownCssClass:"wpmudev-select2-dropdown",tags:"true",width:"100%",createTag:function(){return!1}};-1!==pagenow.indexOf("listing")&&(e.minimumResultsForSearch=-1);var t=function(){a(".wpmudev-select").wpmuiSelect(e)};t(),Hustle.Events.on("modules.view.select.render",function(e){t()})}(jQuery),Hustle.define("Delete_Confirmation",function(i){"use strict";return Backbone.View.extend({el:"#wph-delete-module-confirmation",opts:{id:"",multiple:0,ids:"",nonce:"",action:"",url:ajaxurl},events:{"click .hustle-delete-module-confirm":"confirm","click .hustle-delete-module-cancel":"cancel"},initialize:function(e){this.opts=_.extend({},this.opts,e)},confirm:function(e){e.preventDefault(),e.stopPropagation();var t=this;this.$(e.target).addClass("wpmudev-button-onload"),i.ajax({url:this.opts.url,type:"POST",data:{action:this.opts.action,_ajax_nonce:this.opts.nonce,id:this.opts.id,multiple:this.opts.multiple,ids:this.opts.ids},success:function(e){t.opts.onSuccess&&_.isFunction(t.opts.onSuccess)&&t.opts.onSuccess.call(this,e,t)}})},cancel:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Featured_Image_Holder",function(t){"use strict";return Backbone.View.extend({template:Optin.template("wph-popup-choose_image"),target_div:"",media_frame:!1,options:{attribute:"feature_image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},initialize:function(e){if(this.options=_.extend({},this.options,e),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");e.module_type&&(this.template=Optin.template("wph-"+e.module_type+"-choose_image")),this.target_div=e.target_div,t(document).on("click","button#wpmudev-feature-image-browse",t.proxy(this.open,this)),t(document).on("click",".wpmudev-feature-image-src-input_text",t.proxy(this.open,this)),t(document).on("click","button#wpmudev-feature-image-clear",t.proxy(this.clear,this)),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this.show_or_hide_clear_button(),this},show_or_hide_clear_button:function(){var e=this.model.get("feature_image");""===e||void 0===e?(this.$el.find(".wpmudev-clear_image .wpmudev-button").hide(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","auto")):(this.$el.find(".wpmudev-clear_image .wpmudev-button").show(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","none"))},define_media_frame:function(){var s=this;this.media_frame=wp.media({title:s.options.title,button:{text:s.options.button_text},multiple:s.options.multiple}).on("select",function(){var e=s.media_frame.state().get("selection").first().toJSON();if(e&&e.url){var t=e.url,i="";e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url&&(i=e.sizes.thumbnail.url),s.target_div.find(".wpmudev-feature-image-src-input_text").val(t),s.target_div.find(".wpmudev-inserted_image").css("background-image","url("+i+")"),s.model.set("feature_image",t,{silent:!0}),s.show_or_hide_clear_button()}})},open:function(e){e.preventDefault(),this.media_frame.open()},clear:function(e){e.preventDefault(),this.target_div.find(".wpmudev-feature-image-src-input_text").val(""),this.target_div.find(".wpmudev-inserted_image").css("background-image","url()"),this.model.set("feature_image","",{silent:!0}),this.show_or_hide_clear_button()}})}),Hustle.define("Media_Holder",function(){"use strict";return Backbone.View.extend({template:Optin.template("hustle-media-holder-tpl"),media_frame:!1,options:{attribute:"image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},events:{"click .wph-media--add":"open","click .wph-button--dots":"toggle_options","click .i-close":"toggle_options","click .wpoi-swap-image-button":"swap_image","click .wpoi-delete-image-button":"delete_image"},initialize:function(e){if(this.options=_.extend({},this.options,e),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");jQuery(document).on("click",this.close_media_options),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this},define_media_frame:function(){var t=this,i=this.$(".wph-media--preview"),s=this.$(".wph-media--holder"),o=this.$(".wph-media--options");this.media_frame=wp.media({title:t.options.title,button:{text:t.options.button_text},multiple:t.options.multiple}).on("select",function(){var e=t.media_frame.state().get("selection").first().toJSON();e&&e.url&&(i.css("background-image","url({url})".replace("{url}",e.url)),s.addClass("has-image"),t.model.set(t.options.attribute,e.url),o.removeClass("hidden"),t.$(".wph-media--add").addClass("hidden"))})},open:function(e){e.preventDefault(),this.$(".wph-media--holder").removeClass("has-image"),this.media_frame.open()},toggle_options:function(){this.$("wph-media--list").toggleClass("wph-open"),this.$(".wph-media--items").toggleClass("hidden"),this.$(".svg-triangle").toggleClass("hidden")},close_media_options:function(e){var t=jQuery(e.target);if(0===t.closest(".wph-media--list").length&&!t.hasClass("wph-button wph-button--dots")){var i=jQuery(".wph-media--list"),s=i.find(".wph-media--items"),o=i.find(".svg-triangle");s.hasClass("hidden")||s.addClass("hidden"),o.hasClass("hidden")||o.addClass("hidden")}},swap_image:function(e){e.preventDefault(),this.media_frame&&(this.media_frame.open(),this.toggle_options())},delete_image:function(e){e.preventDefault();var t=this.$(".wph-media--preview");this.model.set(this.options.attribute,""),t.css("background-image","url('')"),this.toggle_options(),this.$(".wph-media--add").removeClass("hidden"),this.$(".wph-media--options").addClass("hidden")}})}),Hustle.define("Upgrade_Modal",function(e){"use strict";return Backbone.View.extend({el:"#wph-upgrade-modal",opts:{},events:{"click .wpmudev-i_close":"close"},initialize:function(e){this.opts=_.extend({},this.opts,e)},close:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Mixins.Model_Updater",function(n,e,t){"use strict";return{init_mix:function(){this.events=_.extend({},this.events,this._events),this.delegateEvents()},_events:{"change input[type='text']":"_update_text","change input[type='number']":"_update_text","change input[type='checkbox']":"_update_checkbox","change input[type=radio]":"_update_radios","change select":"_update_select"},_update_text:function(e){var t=n(e.target),i=t.data("attribute"),s=this[t.data("model")||"model"],o=_.isTrue(t.data("silent"))?{silent:!0}:{};s&&i&&(e.stopPropagation(),s.set.call(s,i,e.target.value,o))},_update_checkbox:function(e){var t=n(e.target),i=t.data("attribute"),s=this[t.data("model")||"model"],o=_.isTrue(t.data("silent"))?{silent:!0}:{};s&&i&&(e.stopPropagation(),s.set.call(s,i,t.is(":checked")?1:0,o))},_update_radios:function(e){var t=n(e.target),i=t.data("attribute"),s=this[t.data("model")||"model"],o=_.isTrue(t.data("silent"))?{silent:!0}:{};s&&i&&(e.stopPropagation(),s.set.call(s,i,e.target.value,o))},_update_select:function(e){var t=n(e.target),i=t.data("attribute"),s=this[t.data("model")||"model"],o=_.isTrue(t.data("silent"))?{silent:!0}:{};s&&i&&(e.stopPropagation(),s.set.call(s,i,t.val(),o))}}}),Hustle.define("Settings.Conditions_View",function(i){"use strict";return Hustle.View.extend({template:Optin.template("wph-wizard-module-conditions"),handle_tpl:Optin.template("wph-wizard-module-conditions-handle"),className:"wph-conditions",events:{"click .wph-conditions--side .wph-conditions--item:not(.disabled)":"toggle_condition","click .wph-conditions--side .wph-conditions--item:not(.disabled) span":"toggle_condition","click .wph-conditions--item header":"toggle_panel"},init:function(e){this.type=e.type,this.active_conditions={},this.listenTo(this.model,"change",this.toggle_empty_message),this.render()},render:function(){var s=this.model.toJSON();this.$el.html(this.template({type_name:this.type})),_.each(Optin.View.Conditions,function(e,t){var i=this.handle_tpl({label:this.get_label(t),id:t,cid:this.get_condition_cid(t),active_class:s[t]?"added":"",icon_class:s[t]?"wph-condition-remove":"wph-condition-add"});this.$(".wph-conditions--side .wph-conditions--items").append(i)},this),_.each(s,function(e,t){this.add_condition_panel(t)},this),this.toggle_empty_message()},get_condition_cid:function(e){return e=e.replace(/ /g,""),this.type+"_"+e},get_label:function(e){var t=optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type;return optin_vars.messages.conditions[e]?optin_vars.messages.conditions[e].replace("{type_name}",t):e},take_care_of_connected_conditions:function(e){e.disable&&e.disable.length&&_.each(e.disable,function(e,t){this.$("#"+this.get_condition_cid(e)).toggleClass("disabled")},this)},add_condition:function(e,t){var i=this.add_condition_panel(e);return t.addClass("added"),t.find("span").addClass("wpoi-remove"),t.find("span").removeClass("wpoi-add"),this.model.set(e,i.get_configs()),this.model.toJSON()},remove_condition:function(e,t,i){this.take_care_of_connected_conditions(t),t.off("change:update_label"),t.remove(),delete this.active_conditions[e],i.removeClass("added"),i.find("span").removeClass("wpoi-remove"),i.find("span").addClass("wpoi-add"),this.model.unset(e)},add_condition_panel:function(e){if(void 0!==Optin.View.Conditions[e]){var t=this.active_conditions[e]=new Optin.View.Conditions[e]({model:this.model,type:this.type});_.isEmpty(this.active_conditions)&&this.$(".wph-conditions--box .wph-conditions--items").html(""),this.take_care_of_connected_conditions(t);var i=this;return t.on("change:update_label",function(){i.trigger("change:update_view_label",i)}),this.$(".wph-conditions--box .wph-conditions--items").append(t.$el),t}},toggle_condition:function(e){e.stopPropagation();var t=this.$(e.target).data("id")||this.$(e.target).closest(".wph-conditions--item").data("id"),i=this.$("#"+this.get_condition_cid(t)),s=this.active_conditions[t];s?(this.remove_condition(t,s,i),this.trigger("condition_removed",this,t,s)):(this.add_condition(t,i),this.trigger("condition_added",this,t,s)),this.trigger("toggle_condition",this,t,s)},toggle_empty_message:function(){this.model.isEmpty()?this.$(".wph-conditions--box .wph-conditions--items").addClass("wph-conditions-is_empty"):this.$(".wph-conditions--box .wph-conditions--items").removeClass("wph-conditions-is_empty"),this.model.isEmpty()?this.$(".wph-conditions--empty").show():this.$(".wph-conditions--empty").hide()},toggle_panel:_.debounce(function(e){var t=i(e.target).closest(".wph-conditions--item");t.find("section").slideToggle(300,function(){t.toggleClass("wph-conditions--closed wph-conditions--open")})},300),get_conditions_labels:function(){var e=_.pluck(this.active_conditions,"label"),t=Hustle.create_template("<span>{{label}}</span>");return e.length?e.map(function(e){return t({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere},get_all_conditions_labels:function(){var e=this.active_conditions,t={posts:{label:optin_vars.messages.condition_labels.all_posts},pages:{label:optin_vars.messages.condition_labels.all_pages},categories:{label:optin_vars.messages.condition_labels.all_categories},tags:{label:optin_vars.messages.condition_labels.all_tags}},i=[];for(var s in t)void 0===e[s]&&i.push(t[s].label);var o=_.pluck(e,"label"),n=Hustle.create_template("<span>{{label}}</span>");return(o=o.concat(i)).length?o.map(function(e){return n({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere}})}),function(a){"use strict";Optin.View.Conditions=Optin.View.Conditions||{};var s=Hustle.View.extend({condition_id:"",className:"wph-conditions--item wph-conditions--open",_template:Optin.template("wph-wizard-module-conditions-item"),template:!1,_defaults:{type_name:"",condition_name:"",label:""},_events:{"change input":"change_input","change textarea":"change_input","change select":"change_input"},init:function(e){return this.type=e.type,this.id=this.type+"-"+this.condition_id,this.template=void 0!==this.cpt?Optin.template("wpoi-condition-post_type"):Optin.template("wpoi-condition-"+this.condition_id),this._defaults={type_name:optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type,condition_name:optin_vars.messages.conditions[this.condition_id]?optin_vars.messages.conditions[this.condition_id]:this.condition_id},this.data=this.get_data(),this.render(),this.events=a.extend(!0,{},this.events,this._events),this.delegateEvents(),this.on_init&&_.isFunction(this.on_init)&&this.on_init.apply(this,arguments),this},get_data:function(){return _.extend({},this._defaults,this.defaults,this.model.get(this.condition_id),{type:this.type})},get_title:function(){return this.title.replace("{type_name}",this.data.type_name)},get_body:function(){return"function"==typeof this.body?this.body.apply(this,arguments):this.body.replace("{type_name}",this.data.type_name)},get_header:function(){return""},render:function(){this.$el.html("");var e=this._template(_.extend({},{title:this.get_title(),body:this.get_body(),header:this.get_header()},this._defaults,{type:this.type}));return this.$el.html(e),a(".wph-conditions--box .wph-conditions--item:not(:last-child)").removeClass("wph-conditions--open").addClass("wph-conditions--closed"),a(".wph-conditions--box .wph-conditions--item:not(:last-child) section").hide(),this.rendered&&"function"==typeof this.rendered&&this.rendered.apply(this,arguments),this},update_attribute:function(e,t){this.data=this.model.get(this.condition_id),this.data[e]=t,this.model.set(this.condition_id,this.data)},get_attribute:function(e){var t=this.model.get(this.condition_id);return!(!t||!t[e])&&t[e]},refresh_label:function(){this.$el.find(".wph-condition--preview").html("");var e=this.get_header();this.$el.find(".wph-condition--preview").html(e)},change_input:function(e){var t=e.target,i=t.getAttribute("data-attribute"),s=a(t),o=s.is(".js-wpoi-select")?s.val():e.target.value;if(s.is(".select2-search__field"))return!1;var n=this.update_attribute(i,o);return this.refresh_label(),n},get_configs:function(){return this.defaults||!0}}),o=function(e){a(".wph-conditions--items").data("select2ScrollPosition",{})},n=function(e){var t=["all"];e.params&&e.params.args&&e.params.args.data&&e.params.args.data.id&&"all"===e.params.args.data.id||((t=a(this).val())&&-1!==t.indexOf("all")?t.splice(t.indexOf("all"),1):t=(t||[]).concat([e.params.args.data.id]),t&&t.length||(t=[e.params.args.data.id])),a(this).val(t).trigger("change")},l={events:{"change input[type='radio']":"set_current_li"},set_current_li:function(e){var t=a(e.target),i=t.closest("li");i.siblings().removeClass("current"),i.toggleClass("current",t.is(":checked"))}};Optin.View.Conditions.posts=s.extend(_.extend({},l,{condition_id:"posts",title:optin_vars.messages.conditions.posts,label:optin_vars.messages.condition_labels.posts,defaults:{filter_type:"only",posts:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("posts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.get_attribute("posts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},update_label:function(){this.get_attribute("posts").length&&!_.contains(this.get_attribute("posts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length?this.get_attribute("posts").length:0):_.contains(this.get_attribute("posts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",n).on("select2:selecting",o).on("select2:unselecting",o)}})),Optin.View.Conditions.pages=s.extend(_.extend({},l,{condition_id:"pages",title:optin_vars.messages.conditions.pages,label:optin_vars.messages.condition_labels.pages,defaults:{filter_type:"only",pages:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("pages"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.get_attribute("pages").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},update_label:function(){this.get_attribute("pages").length&&!_.contains(this.get_attribute("pages"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length?this.get_attribute("pages").length:0):_.contains(this.get_attribute("pages"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",n).on("select2:selecting",o).on("select2:unselecting",o)}})),_.each(optin_vars.post_types,function(e,t){var i=e.label.toLowerCase();Optin.View.Conditions[e.label]=s.extend(_.extend({},l,{condition_id:e.label,title:e.label,label:optin_vars.messages.condition_labels.posts,cpt:!0,defaults:{filter_type:"only",selected_cpts:[],post_type:t,post_type_label:e.label},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("selected_cpts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+i:optin_vars.messages.condition_labels.no+" "+i:this.get_attribute("selected_cpts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length).replace("posts",i):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+i:optin_vars.messages.condition_labels.all+" "+i},update_label:function(){this.get_attribute("selected_cpts").length&&!_.contains(this.get_attribute("selected_cpts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length?this.get_attribute("selected_cpts").length:0).replace("posts",i):_.contains(this.get_attribute("selected_cpts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+i:optin_vars.messages.condition_labels.no+" "+i:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+i:optin_vars.messages.condition_labels.all+" "+i},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",n).on("select2:selecting",o).on("select2:unselecting",o)}}))}),Optin.View.Conditions.categories=s.extend(_.extend({},l,{condition_id:"categories",title:optin_vars.messages.conditions.categories,label:optin_vars.messages.condition_labels.categories,defaults:{filter_type:"only",categories:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("categories"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.get_attribute("categories").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},update_label:function(){this.get_attribute("categories").length&&!_.contains(this.get_attribute("categories"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length?this.get_attribute("categories").length:0):_.contains(this.get_attribute("categories"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",o).on("select2:unselecting",o)}})),Optin.View.Conditions.tags=s.extend(_.extend({},l,{condition_id:"tags",title:optin_vars.messages.conditions.tags,label:optin_vars.messages.condition_labels.tags,defaults:{filter_type:"only",tags:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("tags"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.get_attribute("tags").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},update_label:function(){this.get_attribute("tags").length&&!_.contains(this.get_attribute("tags"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length?this.get_attribute("tags").length:0):_.contains(this.get_attribute("tags"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",o).on("select2:unselecting",o)}})),Optin.View.Conditions.only_on_not_found=s.extend({condition_id:"only_on_not_found",title:optin_vars.messages.conditions.only_on_not_found,label:optin_vars.messages.condition_labels.only_on_not_found,body:optin_vars.messages.conditions_body.only_on_not_found}),Optin.View.Conditions.visitor_logged_in=s.extend({condition_id:"visitor_logged_in",disable:["visitor_not_logged_in"],title:optin_vars.messages.conditions.visitor_logged_in,label:optin_vars.messages.condition_labels.visitor_logged_in,body:optin_vars.messages.conditions_body.visitor_logged_in}),Optin.View.Conditions.visitor_not_logged_in=s.extend({condition_id:"visitor_not_logged_in",disable:["visitor_logged_in"],title:optin_vars.messages.conditions.visitor_not_logged_in,label:optin_vars.messages.condition_labels.visitor_not_logged_in,body:optin_vars.messages.conditions_body.visitor_not_logged_in}),Optin.View.Conditions.shown_less_than=s.extend({condition_id:"shown_less_than",title:optin_vars.messages.conditions.shown_less_than,label:optin_vars.messages.condition_labels.shown_less_than,defaults:{less_than:1},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.only_on_mobile=s.extend({condition_id:"only_on_mobile",disable:["not_on_mobile"],title:optin_vars.messages.conditions.only_on_mobile,label:optin_vars.messages.condition_labels.only_on_mobile,body:optin_vars.messages.conditions_body.only_on_mobile}),Optin.View.Conditions.not_on_mobile=s.extend({condition_id:"not_on_mobile",disable:["only_on_mobile"],title:optin_vars.messages.conditions.not_on_mobile,label:optin_vars.messages.condition_labels.not_on_mobile,body:optin_vars.messages.conditions_body.not_on_mobile}),Optin.View.Conditions.from_specific_ref=s.extend({condition_id:"from_specific_ref",disable:["not_from_specific_ref"],title:optin_vars.messages.conditions.from_specific_ref,label:optin_vars.messages.condition_labels.from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_specific_ref=s.extend({condition_id:"not_from_specific_ref",disable:["from_specific_ref"],title:optin_vars.messages.conditions.not_from_specific_ref,label:optin_vars.messages.condition_labels.not_from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_internal_link=s.extend({condition_id:"not_from_internal_link",title:optin_vars.messages.conditions.not_from_internal_link,label:optin_vars.messages.condition_labels.not_from_internal_link,body:optin_vars.messages.conditions_body.not_from_internal_link}),Optin.View.Conditions.from_search_engine=s.extend({condition_id:"from_search_engine",title:optin_vars.messages.conditions.from_search_engine,label:optin_vars.messages.condition_labels.from_search_engine,body:optin_vars.messages.conditions_body.from_search_engine}),Optin.View.Conditions.on_specific_url=s.extend({condition_id:"on_specific_url",disable:["not_on_specific_url"],title:optin_vars.messages.conditions.on_specific_url,label:optin_vars.messages.condition_labels.on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_on_specific_url=s.extend({condition_id:"not_on_specific_url",disable:["on_specific_url"],title:optin_vars.messages.conditions.not_on_specific_url,label:optin_vars.messages.condition_labels.not_on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.visitor_has_commented=s.extend({condition_id:"visitor_has_commented",disable:["visitor_has_never_commented"],title:optin_vars.messages.conditions.visitor_has_commented,label:optin_vars.messages.condition_labels.visitor_has_commented,body:optin_vars.messages.conditions_body.visitor_has_commented}),Optin.View.Conditions.visitor_has_never_commented=s.extend({condition_id:"visitor_has_never_commented",disable:["visitor_has_commented"],title:optin_vars.messages.conditions.visitor_has_never_commented,label:optin_vars.messages.condition_labels.visitor_has_never_commented,body:optin_vars.messages.conditions_body.visitor_has_never_commented}),Optin.View.Conditions.in_a_country=s.extend({condition_id:"in_a_country",disable:["not_in_a_country"],title:optin_vars.messages.conditions.in_a_country,label:optin_vars.messages.condition_labels.in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",o).on("select2:unselecting",o)}}),Optin.View.Conditions.not_in_a_country=s.extend({condition_id:"not_in_a_country",disable:["in_a_country"],title:optin_vars.messages.conditions.not_in_a_country,label:optin_vars.messages.condition_labels.not_in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",o).on("select2:unselecting",o)}})}(jQuery),Hustle.define("Settings.Display_Triggers_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-settings-display-triggers-tpl"),events:{"click .tabs-header label":"change_tab"},init:function(e){this.type=e.type,this.listenTo(this.model,"change:on_adblock",this.hide_adblock_options_on_toggle),this.render()},render:function(){return this.$el.html(this.template(this.get_data())),this.hide_adblock_options_on_toggle(),this},get_data:function(){var e={};return e.type=this.type,_.extend({},e,this.model.toJSON())},change_tab:function(e){e.preventDefault();var t=this.$(e.target),i=t.parent("li"),s=this.$(t.attr("href")),o=t.find("input[type='radio']");this.$(".tabs-header li").removeClass("current"),this.$(".tabs-content").removeClass("current"),i.addClass("current"),s.addClass("current"),o.prop("checked",!0),this.model.set("trigger",o.val())},hide_adblock_options_on_toggle:function(){_.isTrue(this.model.get("on_adblock"))?this.$(".wpoi-popup-trigger-on-adblock-option").show():this.$(".wpoi-popup-trigger-on-adblock-option").hide()}}))}),Hustle.define("Settings.Mail_Settings",function(o){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-mail",events:{"submit #wpmudev-settings-mail-form":"save_email_settings"},initialize:function(){},save_email_settings:function(e){e.preventDefault();var t=this.$(e.target),i=t.data("nonce"),s=t.serialize();t.find("button[type=submit]").prop("disabled",!0),o.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_global_email_settings",data:s,_ajax_nonce:i},success:function(e){e.success&&(t.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),setTimeout(function(){t.find(".wpmudev-label--success").remove(),t.find("button[type=submit]").prop("disabled",!1)},3e3))}})}})}),Hustle.define("Settings.Modules_Activity",function(n){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-activity",events:{"change .hustle-for-admin-user-toggle":"toggle_for_user","change .hustle-for-logged-in-user-toggle":"toggle_for_user"},initialize:function(){},toggle_for_user:function(e){var i=this.$(e.target),t=i.data("id"),s=i.data("nonce"),o=i.data("user");i.attr("disabled",!0),n.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_for_user",id:t,_ajax_nonce:s,user_type:o},complete:function(e,t){i.attr("disabled",!1)},success:function(e){e.success||i.prop("checked",!i.is(":checked"))},error:function(){i.prop("checked",!i.is(":checked"))}})}})}),Hustle.define("Settings.Services_Edit_Modal",function(n){"use strict";return Backbone.View.extend({template:Hustle.template("wph-edit-provider-modal-tpl"),id:"wph-edit-provider-modal",events:{"click .i-close":"close","click .js-wph-button-cancel":"close","change #wph-provider-edit-modal-provider":"get_provider_options","click #wph-edit-service-save":"save_settings","submit form":"save_settings"},provider_options_nonce:!1,initialize:function(){this.render()},render:function(){var t=this;this.$el.html(this.template()).appendTo("body"),n.ajax({url:ajaxurl,type:"get",data:{action:"hustle_get_providers_edit_modal_content",id:t.model.get("id"),source:t.model.get("source"),_ajax_nonce:t.model.get("nonce")},success:function(e){e.success&&(t.$(".wph-edit-provider-modal-content").html(e.data.html),t.provider_options_nonce=e.data.provider_options_nonce,Hustle.Events.trigger("view.rendered",t))}})},get_provider_options:function(e){var t=this,i=this.$(e.target),s=this.$("#optin_new_provider_account_details"),o=this.$("#optin_new_provider_account_options");s.empty(),o.empty(),n.ajax({url:ajaxurl,type:"get",data:{action:"render_provider_account_options",provider_id:i.val(),_ajax_nonce:t.provider_options_nonce,optin:t.model.get("id")},success:function(e){e.success&&(s.html(e.data),Hustle.Events.trigger("view.rendered",t))}})},close:function(e){e.preventDefault(),this.remove()},hide:function(){},show:function(){},save_settings:function(e){e.preventDefault();var t=this.$(e.target),i=t.data("nonce"),s=this.$("#wph-provider-edit-modal-provider"),o=t.closest("form");n.ajax({url:ajaxurl,type:"post",data:{action:"hustle_save_providers_edit_modal",provider_id:s.val(),_ajax_nonce:i,id:this.model.get("id"),source:this.model.get("source"),form:o.serialize()},success:function(e){}})}})}),Hustle.define("Settings.Services",function(e){"use strict";return Backbone.View.extend({el:"#providers-edit-box",Modal_View:Hustle.get("Settings.Services_Edit_Modal"),modal:!1,events:{"click .wph-providers-edit":"open_edit_modal"},open_edit_modal:function(e){var t=this.$(e.target),i=t.data("id"),s=t.data("source"),o=t.data("nonce");this.modal=new this.Modal_View({model:new Backbone.Model({id:i,nonce:o,source:s})})}})}),Hustle.define("Settings.Unsubscribe_Settings",function(o){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-unsubscribe",events:{"submit #wpmudev-settings-unsubscribe-messages":"save_unsubscription_messages","submit #wpmudev-settings-unsubscribe-email":"save_unsubscription_email"},initialize:function(){},save_unsubscription_messages:function(e){e.preventDefault();var t=this.$(e.target),i=t.data("nonce"),s=t.serialize();t.find("button[type=submit]").addClass("wpmudev-button-onload"),o.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_messages_settings",data:s,_ajax_nonce:i},success:function(e){e.success&&(t.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),t.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){t.find(".wpmudev-label--success").remove()},1e3))}})},save_unsubscription_email:function(e){e.preventDefault();var t=this.$(e.target),i=t.data("nonce"),s=t.serialize();t.find("button[type=submit]").addClass("wpmudev-button-onload"),o.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_email_settings",data:s,_ajax_nonce:i},success:function(e){e.success&&(t.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),t.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){t.find(".wpmudev-label--success").remove()},1e3))}})}})}),function(n,e){"use strict";n(document).on("click",".wpoi-listing-wrap header.can-open .toggle, .wpoi-listing-wrap header.can-open .toggle-label",function(e){e.stopPropagation()}),n(".accordion header .optin-delete-optin, .accordion header .edit-optin, .wpoi-optin-details tr .button-edit").hide().css({transition:"none"}),n(document).on({mouseenter:function(){n(this).find(".optin-delete-optin, .edit-optin").stop().fadeIn("fast")},mouseleave:function(){var e=n(this);e.find(".toggle-checkbox").removeProp("disabled"),e.find(".edit-optin").removeProp("disabled"),e.removeClass("disabled"),e.find(".optin-delete-optin, .edit-optin, .delete-optin-confirmation").stop().fadeOut("fast")}},".accordion header"),n(document).on({mouseenter:function(){n(this).find(".button-edit").stop().fadeIn("fast")},mouseleave:function(){n(this).find(".button-edit").stop().fadeOut("fast")}},".wpoi-optin-details tr"),n(document).on("click",".wpoi-tabs-menu a",function(e){e.preventDefault();var t=n(this).attr("tab");Optin.router.navigate(t,!0)}),n(document).on("click",".edit-optin",function(e){e.stopPropagation(),e.preventDefault(),window.location.href=n(this).attr("href")}),n(document).on("click",".wpoi-type-edit-button",function(e){e.preventDefault();var t=n(this).data("id"),i=n(this).data("type");window.location.href="admin.php?page=inc_optin&optin="+t+"#display/"+i}),n(document).on("click","*[for]",function(e){var t=n(this),i=t.attr("for"),s=n("#"+i);!t.is("label")&&s.length&&(s.trigger("change"),s.trigger("click"))}),n("#wpoi-complete-message").fadeIn(),n(document).on("click","#wpoi-complete-message .next-button button",function(e){n("#wpoi-complete-message").fadeOut()}),n(document).on("click",".wpoi-listing-page .wpoi-listing-wrap header.can-open",function(e){n(this).find(".open").trigger("click")}),n(document).on("click",".wpoi-listing-page .wpoi-listing-wrap .can-open .open",function(e){e.stopPropagation();var t=n(this).closest(".wpoi-listing-wrap"),i=t.find("section"),s=n(".wpoi-listing-wrap").not(t),o=n(".wpoi-listing-wrap section").not(i);o.slideUp(300,function(){o.removeClass("open")}),s.find(".dev-icon").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),i.slideToggle(300,function(){t.toggleClass("open"),t.find(".dev-icon").toggleClass("dev-icon-caret_up dev-icon-caret_down")})}),Optin.decorate_number_inputs=function(e){var t=e&&e.$el?e.$el.find(".wph-input--number input"):n(".wph-input--number input"),i=Hustle.create_template('<div class="wph-nbr--nav"><div class="wph-nbr--button wph-nbr--up {{disabled}}">+</div><div class="wph-nbr--button wph-nbr--down {{disabled}}">-</div></div>');t.each(function(){var e=n(this),t=e.is(":disabled")?"disabled":"";e.siblings(".wph-nbr--nav").length||e.after(i({disabled:t}))})},Hustle.Events.on("view.rendered",Optin.decorate_number_inputs),n(document).on("click",".wph-nbr--up:not(.disabled)",function(e){var t,i=n(this).closest(".wph-input--number").find("input"),s=parseFloat(i.val());i.attr("min"),(t=i.attr("max")<=s?s:s+1)!==s&&i.val(t).trigger("change")}),n(document).on("click",".wph-nbr--down:not(.disabled)",function(e){var t,i=n(this).closest(".wph-input--number").find("input"),s=parseFloat(i.val()),o=i.attr("min");i.attr("max"),(t=s<=o?s:s-1)!==s&&i.val(t).trigger("change")}),function(){function e(){var e=n(window).scrollTop(),t=n(".wph-sticky--anchor");t.length&&((t=t.offset().top)<e?(n(".wph-preview--eye").addClass("wph-sticky--element"),n(".wph-sticky--anchor").height(n(".wph-preview--eye").outerHeight())):(n(".wph-preview--eye").removeClass("wph-sticky--element"),n(".wph-sticky--anchor").height(0)))}n(function(){n(window).scroll(e),e()})}()}(jQuery,document),function(a){"use strict";Optin.Provider=function(e){var n=this;return _.extend(this,{id:!1,provider_args:{},errors:{},render_in_previewr:_.noop,init:_.noop,add_args:function(){n.id===Optin.step.services.model.get("optin_provider")&&_.each(n.provider_args,function(e,t){var i=a(e);i.length&&(i=i.val().trim(),Optin.step.services.provider_args.set(t,i))})},clear_provider_args:function(){n.id===Optin.step.services.model.previousAttributes().optin_provider&&n.id!==Optin.step.services.model.get("optin_provider")&&Optin.step.services.provider_args.clear({silent:!0})},validate:function(){var o=[];return _.each(n.provider_args,function(e,t){var i=a(e),s=a("<span></span>");0<i.length&&""===i.val().trim()&&(o.push(n.errors[t]),s.attr("title",n.errors[t].message),i.addClass("wpoi-error"),i.after(s),_.defer(function(){s.addClass("dashicons dashicons-warning "+n.errors[t].iconClass)}))}),_(o)},check_module_field:function(e,t,i){a.getJSON(window.ajaxurl,{action:"add_module_field",provider:this.id,_wpnonce:optin_vars.get_module_field_nonce,optin_id:t,field:e},i).fail(function(){i&&i({error:!0})})},validate_custom_field:function(s,o,e){o.$(".dashicons-warning").remove(),o.$("[name]").prop("disabled",!0),this.check_module_field(s,e,function(e){if(o.$("[name]").prop("disabled",!1),e.success)o.options=s,o._updateOptions();else{var t=a('<span class="dashicons dashicons-warning">'),i="custom"!==e.data.code?optin_vars.messages.module_fields[e.data.code]:e.data.message;t.attr("title",i),o.$('[name="label"]').before(t)}})},add_module_field:function(s,o,e){var n=o.$(".wph-add-new-field","#wpoi-module-field-maker");n.addClass("wp-button-save--loading"),n.prop("disabled",!0),this.check_module_field(s,e,function(e){if(n.prop("disabled",!1),e.success)s=e.data.field,o._add_module_field(s);else{var t=a('<span class="dashicons dashicons-warning">'),i="custom"!==e.data.code?optin_vars.messages.module_fields[e.data.code]:e.data.message;t.attr("title",i),n.before(t)}})}},e),this.init(),Optin.Events.on("services:validate:after",a.proxy(this,"add_args")),Optin.Events.on("design:preview:render:start",a.proxy(this,"clear_provider_args")),Optin.Events.on("optin:add_module_field_"+this.id,a.proxy(this,"add_module_field")),Optin.Events.on("optin:update_module_field_"+this.id,a.proxy(this,"validate_custom_field")),this}}(jQuery,document),function(a){"use strict";var e=Object.keys(optin_vars.providers);_.each(e,function(s){Optin.Mixins.add_services_mixin(s,function(t){return new Optin.Provider({id:s,supports_fields:!0===optin_vars.providers[s].supports_fields,provider_args:{enabled:0},default_data:{enabled:!1,api_key:""},show_selected:function(){t.editing_service,this.id},get_custom_args:function(e){var t=a("#wph-add-new-service-modal").find("form"),i=t.serializeArray(),s={},o=t.find('[name="list_id"]');if(e){var n=["_wp_http_referer","_wpnonce"];a.each(i,function(e,t){-1===a.inArray(t.name,n)&&(s.hasOwnProperty(t.name)?"string"==typeof s[t.name]?s[t.name]=[s[t.name],t.value]:s[t.name].push(t.value):s[t.name]=t.value)})}else a.each(i,function(e,t){s[t.name]=t.value});return t.find("input:checkbox").each(function(){this.checked||s.hasOwnProperty(this.name)||(s[this.name]=0)}),0<o.length&&(s.list_name=o.children(":selected").text()),s},pre_update_args:function(e){if(e.editing_service===this.id){if(void 0===e.service_modal.pre_saved&&(e.service_modal.pre_saved={}),!e.service_modal.prev_step){var t={enabled:!!e.model.get("email_services")[s]&&e.model.get("email_services")[s].enabled};_.extend(e.service_modal.pre_saved,t)}_.extend(e.service_modal.pre_saved,this.get_custom_args(!0))}},update_args:function(i){if(i.editing_service===this.id){_.extend(i[s].provider_args,i.service_modal.pre_saved);a.each(["step","is_step","current_step","slug","module_id","module_type"],function(e,t){void 0!==i[s].provider_args[t]&&delete i[s].provider_args[t]}),Hustle.Events.trigger("optin.service.saved",i)}},init:function(){a(document).on("change","#wph-optin-service-details-form input",function(e){t.is_service_modal_updated=!0}),Hustle.Events.on("optin.service.pre_save",a.proxy(this.pre_update_args,this)),Hustle.Events.on("optin.service.prepare",a.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",a.proxy(this.show_selected,this))}})})})}(jQuery,document);var Module=window.Module||{};Hustle.define("Model",function(i){"use strict";return Backbone.Model.extend({initialize:function(){this.on("change",this.user_has_change,this),Backbone.Model.prototype.initialize.apply(this,arguments);var e=this.attributes;this.display_preview_button(e)},user_has_change:function(){Module.hasChanges=!0;var e=this.attributes;this.display_preview_button(e)},display_preview_button:function(e){var t=i(".wpmudev-preview");e.has_title||""!==e.main_content||e.use_feature_image||e.show_cta||e.use_email_collection?t.show():t.hide()}})}),Hustle.define("Models.M",function(){"use strict";return Hustle.get("Model").extend({toJSON:function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},set:function(e,t,i){if("string"==typeof e&&-1!==e.indexOf(".")){var s=e.split(".")[0],o=e.split(".")[1],n=this.get(s);n&&n instanceof Backbone.Model&&(n.set(o,t,i),this.trigger("change:"+e,e,t,i),this.trigger("change:"+s,e,t,i))}else Backbone.Model.prototype.set.call(this,e,t,i)},get:function(e){if("string"!=typeof e||-1===e.indexOf("."))return Backbone.Model.prototype.get.call(this,e);var t=e.split(".")[0],i=e.split(".")[1];return this.get(t).get(i)}})}),Hustle.define("Models.Trigger",function(){"use strict";return Hustle.get("Model").extend({defaults:{trigger:"time",on_time:!1,on_time_delay:5,on_time_unit:"seconds",on_scroll:"scrolled",on_scroll_page_percent:"20",on_scroll_css_selector:"",on_click_element:"",on_exit_intent:!0,on_exit_intent_per_session:!0,on_exit_intent_delayed:!1,on_exit_intent_delayed_time:5,on_exit_intent_delayed_unit:"seconds",on_adblock:!1,on_adblock_delayed:!1,on_adblock_delayed_time:5,on_adblock_delayed_unit:"seconds"}})}),Module.Model=Hustle.get("Models.M").extend({defaults:{module_name:"",module_type:"popup",active:0,test_mode:0}}),function(p){"use strict";var d=window.Module||{};d.Alert=Backbone.View.extend({template:Optin.template("optin-alert-modal"),events:{"click .inc-opt-alert-modal-close":"close","click .inc-opt-alert-modal":"close","click .inc-opt-alert-modal-close-btn":"close","click .inc-opt-alert-modal-inner-container":"prevent_close"},initialize:function(e){return this.options=e,this.render()},render:function(){this.$el.html(this.template(_.extend({close_text:optin_vars.messages.ok},this.options))),this.$el.appendTo("body")},close:function(e){this.$el.hide(),this.remove()},prevent_close:function(e){e.preventDefault(),e.stopPropagation()}}),d.Service_Modal=Backbone.View.extend({template:Optin.template("wpmudev-hustle-modal-add-new-service-tpl"),service_modal_target:"#wph-add-new-service-modal .wpmudev-box-modal",add_service_modal:p("#wph-add-new-service-modal"),initialize:function(e){return this.step=0,this.next_step=!1,this.prev_step=!1,this.options=e,this.view=e.view,this.render()},render:function(){return this},add_service:function(e){this.view.is_service_modal_updated=!1;var t=_.extend({is_new:!0,service:"mailchimp"}),i=p(this.service_modal_target);e.closest("a").data("nonce");i.html(""),i.append(this.template(t)),this.show_modal(!1)},edit_service:function(e){this.view.is_service_modal_updated=!0;var t=e.closest("a"),i=t.data("id"),s=_.extend({is_new:!1,service:i}),o=p(this.service_modal_target);this.nonce=t.data("nonce"),o.html(""),o.append(this.template(s)),this.view.editing_service=i,this.get_form_settings(),this.show_modal(!0)},on_provider_changed:function(e){var t=p(e.target).val();this.view.editing_service!==t&&(this.view.is_service_modal_updated=!0),this.add_service_modal.find("#optin-provider-account-options").html(""),this.view.service_modal.pre_saved={},this.view.editing_service=t,this.get_form_settings()},on_click_ajax:function(e){e.preventDefault();this.view;var t=p(e.target),i=t.closest("form"),s=this.add_service_modal.find("."+e.target.id+"-empty"),o=this.add_service_modal.find("."+e.target.id+"-hide"),n=this.add_service_modal.find("."+e.target.id+"-show"),a=p(e.target).data("dom_wrapper"),l=_.extend({},t.data()),d=_.reduce(i.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});d.module_id=this.view.module_id,d._ajax_nonce=t.data("nonce"),"undefined"!==l.nonce&&delete l.nonce,this.view.is_service_modal_updated=!0,s.empty(),o.hide(),n.show(),void 0!==a&&this.add_service_modal.find(a).html(p("#wpoi-loading-indicator").html()),d=_.extend({},this.view.service_modal.pre_saved,l,d),t.addClass("wpmudev-button-onload"),this.custom_request(d)},on_change_ajax:function(e){var t=p(e.target),i=t.closest("form"),s=this.add_service_modal.find("."+e.target.id+"-empty"),o=this.add_service_modal.find("."+e.target.id+"-hide"),n=this.add_service_modal.find("."+e.target.id+"-show"),a=p(e.target).data("dom_wrapper"),l=_.extend({},t.data()),d=_.reduce(i.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});if(d._ajax_nonce=t.data("nonce"),void 0!==a){var r=this.add_service_modal.find(a);if(r.html(p("#wpoi-loading-indicator").html()),-1!==["-1","0"].indexOf(e.target.value))return void r.empty()}"undefined"!==l.select2&&delete l.select2,"undefined"!==l.nonce&&delete l.nonce,_.extend(d,this.view.service_modal.pre_saved,l),s.empty(),o.hide(),n.show(),this.custom_request(d)},continue_next_step:function(e){e.preventDefault(),Hustle.Events.trigger("optin.service.pre_save",this.view);var t={};this.view.editing_service;t.data={},t.data=this.view.service_modal.pre_saved,t.data.is_step=!0,t.data.step=this.get_step(),t.data.current_step=this.step,t.data.slug=this.view.editing_service,t.data.module_id=this.view.module_id,t.data.module_type=this.view.module_type,t.action=this.action,t._ajax_nonce=this.nonce,this.request(t,!0)},go_prev_step:function(e){e.preventDefault();var t={},i=this.view.editing_service;t.data={},t.data=this.view[i].provider_args,t.data.is_step=!0,t.data.step=this.get_prev_step(),t.data.current_step=this.step,t.data.slug=this.view.editing_service,t.data.module_id=this.view.module_id,t.data.module_type=this.view.module_type,t.action=this.action,t._ajax_nonce=this.nonce,this.request(t,!0)},get_form_settings:function(){var e={};e.action=this.action="provider_form_settings",e.data={},e.data=this.view[this.view.editing_service].provider_args,e.data.is_step=!1,e.data.slug=this.view.editing_service,e.data.step=this.step=0,e.data.current_step=this.step,e.data.module_id=this.view.module_id,e.data.module_type=this.view.module_type,e._ajax_nonce=this.nonce,this.request(e,!1)},custom_request:function(e){var t=this;p.post({url:ajaxurl,type:"post",data:e}).done(function(e){e&&e.success&&(void 0!==e.data.html&&void 0!==e.data.wrapper&&t.render_custom_body(e.data.html,e.data.wrapper),void 0!==e.data.redirect_url&&_.delay(function(){window.location=e.data.redirect_url},300),void 0!==e.data.is_close&&e.data.is_close&&t.close_modal()),p(".wpmudev-button-onload").removeClass("wpmudev-button-onload")})},render_custom_body:function(e,t){t&&p(t).html(e),Hustle.Events.trigger("modules.view.rendered",this.view)},request:function(e,t){t&&(this.add_service_modal.find("#optin-provider-account-options").html(""),this.add_service_modal.find("#wph-provider-account-details").html(p("#wpoi-loading-indicator").html()),this.add_service_modal.find(".hustle-provider-next").addClass("wpmudev-button-onload"),this.add_service_modal.find(".hustle-provider-prev").addClass("wpmudev-button-onload"));var i=this;p.post({url:ajaxurl,type:"post",data:e}).done(function(e){e&&e.success&&(i.render_body(e),i.render_footer(e),void 0!==e.data.data.data_to_save&&t&&(_.extend(i.view.service_modal.pre_saved,e.data.data.data_to_save),Hustle.Events.trigger("optin.service.prepare",i.view)),t||i.display_saved_values(),i.update_view(e),!_.isUndefined(e.data.data.is_close)&&e.data.data.is_close&&i.close_modal()),p(".wpmudev-button-onload").removeClass("wpmudev-button-onload")})},render_body:function(e){this.add_service_modal.find("#wph-provider-account-details").html(e.data.data.html),Hustle.Events.trigger("modules.view.rendered",this.view)},render_footer:function(e){var t=this,i=e.data.data.buttons;this.add_service_modal.find(".wpmudev-box-footer").html(""),_.each(i,function(e){t.add_service_modal.find(".wpmudev-box-footer").append(e.markup)}),Hustle.Events.trigger("modules.view.rendered",this.view)},display_saved_values:function(){var o=this.view.model.get("email_services"),n=this.view.editing_service;if(void 0===o||_.isEmpty(o)||void 0===o[n])this.add_service_modal.find("#optin-provider-saved-args").hide();else{var a=this,e=(n=this.view.editing_service,"api_key"in o[n]?o[n].api_key:"");""!==e&&p('input[name="api_key"]').attr("value",e),p.each(o[n],function(e,t){var i=a.add_service_modal.find(".current_"+e);if(0<i.length){var s="";s="string"==typeof t||"number"==typeof t?t:"array"==typeof t?t.join(", "):p.map(o[n],function(e){return e}).join(", "),i.text(s)}})}},update_view:function(e){_.isUndefined(e.data.data.opt_in_provider_has_next_step)||(this.next_step=!0===e.data.data.opt_in_provider_has_next_step),_.isUndefined(e.data.data.opt_in_provider_has_prev_step)||(this.prev_step=!0===e.data.data.opt_in_provider_has_prev_step),_.isUndefined(e.data.data.opt_in_provider_current_step)||(this.step=+e.data.data.opt_in_provider_current_step)},get_step:function(){return this.next_step?this.step+1:this.step},get_prev_step:function(){return this.prev_step?this.step-1:this.step},clear_options:function(e){e.preventDefault();var t=p(e.target).data("name");p('input[name="'+t+'"').prop("checked",!1)},show_modal:function(e){var t=p("#wph-add-new-service-modal").find(".wpmudev-box-modal"),i=this.view,s=this,o=this.view.model.get("email_services");this.add_service_modal.addClass("wpmudev-modal-active"),p("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){t.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",i),p(document).off("click",".hustle-provider-next",p.proxy(s.continue_next_step,s)),p(document).on("click",".hustle-provider-next",p.proxy(s.continue_next_step,s)),p(document).off("click",".hustle-provider-prev",p.proxy(s.go_prev_step,s)),p(document).on("click",".hustle-provider-prev",p.proxy(s.go_prev_step,s)),p(document).off("click",".hustle_provider_on_click_ajax",p.proxy(s.on_click_ajax,s)),p(document).on("click",".hustle_provider_on_click_ajax",p.proxy(s.on_click_ajax,s)),p(document).off("change",".hustle_provider_on_change_ajax",p.proxy(s.on_change_ajax,s)),p(document).on("change",".hustle_provider_on_change_ajax",p.proxy(s.on_change_ajax,s)),p(document).off("click",".clear_options",p.proxy(s.clear_options,s)),p(document).on("click",".clear_options",p.proxy(s.clear_options,s)),p(document).off("change",'select[name="optin_provider_name"]',p.proxy(s.on_provider_changed,s)),p(document).on("change",'select[name="optin_provider_name"]',p.proxy(s.on_provider_changed,s)),Hustle.Events.off("optin.service.saved",p.proxy(s.save_email_service)),Hustle.Events.on("optin.service.saved",p.proxy(s.save_email_service)),s.hide_or_show_other_services(e),e&&!_.isEmpty(o)?Hustle.Events.trigger("optin.service.show.selected",i):t.find('select[name="optin_provider_name"]').trigger("change")},100)},hide_or_show_other_services:function(e){var t=p("#wph-provider-select .wpmudev-select"),i=this.view.model.get("email_services");(_.isEmpty(i)&&(i={mailchimp:this.view.mailchimp.default_data}),e)||t.find("option").each(function(){var e=p(this).attr("value");(e in i||"mailchimp"===e)&&p(this).remove()})},save_email_service:function(e){var t=e.editing_service,i=e[t].provider_args,s={};s[t]=i,e.model.set("email_services",s),"1"===i.enabled?e.model.set("active_email_service",t):e.model.set("active_email_service",""),_.isUndefined(e.service_modal.pre_saved)||_.isEmpty(e.service_modal.pre_saved)||!_.isUndefined(e.service_modal.next_step)&&e.service_modal.next_step||delete e.service_modal.pre_saved,e.service_modal.append_added_service(t,i)},close_modal:function(){this.add_service_modal.find(".wpmudev-i_close").click()},append_added_service:function(e,t){var i=p("tr.wph-wizard-content-email-providers").last(),s=i.clone();i.html(s.html()),(o=p("tr.wph-wizard-content-email-providers").last()).addClass("updated-email-provider"),o.siblings().removeClass("updated-email-provider");var o,n=(o=p("tr.updated-email-provider")).find("input.wph-email-service-toggle"),a=n.siblings("label"),l=Optin.template("wpmudev-"+e+"-optin-provider-icon-svg"),d=o.find(".wph-email-providers-icon"),r=o.find("a.wph-email-service-edit-link"),c="desc"in t?t.desc:"";n.attr("id","wph-popup-list_"+e),n.attr("data-attribute",e+"_service_provider"),n.prop("checked","true"===t.enabled||"1"===t.enabled),a.attr("for","wph-popup-list_"+e),r.attr("data-id",e),d.html(l()),e in optin_vars.providers&&(r.find("span.wpmudev-table_name").text(optin_vars.providers[e].title),r.find("span.wpmudev-table_desc:first").text(c))}}),d.Form_Fields=Backbone.View.extend({edit_fields_modal:p("#wph-edit-form-modal"),field_list_template:Optin.template("wpmudev-hustle-modal-view-form-fields-tpl"),fields_template:Optin.template("wpmudev-hustle-modal-manage-form-fields-tpl"),new_fields_template:Optin.template("wpmudev-hustle-modal-add-form-fields-tpl"),fields_modal_target:"#wph-edit-form-modal .wpmudev-box-modal",initialize:function(e){return this.options=e,this.view=e.view,this.render()},render:function(){return this},manage_form:function(){var s=this,e=(this.view,p(s.fields_modal_target)),t=this.view.model.get("form_elements");"object"!=typeof t&&(t=JSON.parse(t)),e.html(""),e.append(s.fields_template(_.extend({form_fields:t})));var i=e.find("form#wph-optin-form-fields-form .wpmudev-table-body");i.length&&_.each(t,function(e,t){i.append(s.new_fields_template(_.extend({field:e,new_field:!1})))});var o=s.edit_fields_modal.find(".wpmudev-box-modal"),n=s.edit_fields_modal.find(".wpmudev-table-body"),a=s.edit_fields_modal.find(".wpmudev-table-body-row"),l=s.edit_fields_modal.find("#wph-new-form-field"),d=s.edit_fields_modal.find(".wpmudev-i_close"),r=s.edit_fields_modal.find("#wph-cancel-edit-form"),c=s.edit_fields_modal.find("#wph-save-edit-form"),u=s.edit_fields_modal.find(".wph-field-row");s.edit_fields_modal.addClass("wpmudev-modal-active"),p("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){o.addClass("wpmudev-show"),l.on("click",p.proxy(s.new_form_field,s)),c.on("click",p.proxy(s.save_form_fields,s)),n.sortable(),n.disableSelection(),a.each(function(){var t=p(this),e=t.find(".wpmudev-preview-item-manage"),i=t.find(".wpmudev-icon-delete");e.on("click",function(e){e.stopPropagation(),t.toggleClass("wpmudev-open")}),i.on("click",function(e){e.preventDefault(),e.stopPropagation(),s.delete_form_field(p(this))})}),d.on("click",function(e){e.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){s.edit_fields_modal.removeClass("wpmudev-modal-active"),p("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},500)}),r.on("click",function(e){e.preventDefault(),e.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){s.edit_fields_modal.removeClass("wpmudev-modal-active"),p("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},500)}),u.each(function(){s.form_fields_header(p(this))}),Hustle.Events.trigger("modules.view.select.render",s),Hustle.Events.off("optin.service.saved",p.proxy(s.persist_form_fields,s)),Hustle.Events.on("optin.service.saved",p.proxy(s.persist_form_fields,s))},100)},new_form_field:function(e){e.preventDefault(),e.stopPropagation();var t=this,i=(t.view,t.edit_fields_modal.find(".wpmudev-table-body")),s=t.edit_fields_modal.find("#wph-new-form-field"),o=this.view.model.get("save_local_list"),n=this.view.model.get("active_email_service");if(d.Utils.service_supports_fields(o,n)){i.find(".wpmudev-table-body-row").each(function(){p(this).removeClass("wpmudev-open")}),i.prepend(t.new_fields_template(_.extend({field:{delete:!0},new_field:!0})));var a=i.find(".wpmudev-preview-item-manage:first"),l=i.find(".wpmudev-icon-delete");a.on("click",function(e){e.stopPropagation(),p(this).closest(".wpmudev-table-body-row").toggleClass("wpmudev-open")}),l.on("click",function(e){e.preventDefault(),e.stopPropagation(),t.delete_form_field(p(this))}),t.form_fields_header(i.find(".wpmudev-table-body-row:first")),Hustle.Events.trigger("modules.view.select.render",t),t.update_model_fields(t)}else s.html(optin_vars.messages.form_fields.errors.custom_field_not_supported)},delete_form_field:function(e){e.data("id");var t=e.closest(".wph-field-row.wpmudev-table-body-row");t.fadeOut("fast",function(){t.remove()})},form_fields_header:function(e){var t=e.find(".wpmudev-table-body-content input, .wpmudev-table-body-content select"),i=e.find(".wpmudev-table-body-preview"),s=i.closest(".wpmudev-table-body-row");t.each(function(){p(this).is(":checkbox")?p(this).on("change",function(e){p(this).is(":checked")?i.find(".wpmudev-preview-item-required").html('<span class="wpdui-fi wpdui-fi-check"></span>'):i.find(".wpmudev-preview-item-required").html("")}):p(this).on("change keyup keypress",function(e){var t=p(this).attr("name");i.find(".wpmudev-preview-item-"+t).html(p(this).val()),"name"===t&&s.attr("data-id",p(this).val())})})},save_form_fields:function(e){e.preventDefault(),e.stopPropagation();var i=this;i.view;i.update_model_fields(i,function(e){var t=i.field_list_template({form_fields:e});p(".wph-form-element-list").empty(),p(".wph-form-element-list").html(t),i.edit_fields_modal.find(".wpmudev-i_close").click()})},update_model_fields:function(e,t){var i=e.view,s=e.edit_fields_modal.find(".wph-field-row"),o={},n={};s.each(function(){var i=p(this).attr("data-id"),e=p(this).find(".wpmudev-table-body-content input, .wpmudev-table-body-content select");n[i]={},e.each(function(){var e=p(this).attr("name"),t=p(this).val();"required"===e&&(t=p(this).is(":checkbox")?p(this).is(":checked"):"true"===t),"delete"===e&&(t="true"===t),n[i][e]=t}),o[i]=n[i]}),i.current_form_elements=o,i.model.set("form_elements",o,{silent:!0}),void 0!==t&&"function"==typeof t&&t(o)},persist_form_fields:function(e){"object"==typeof e.current_form_elements&&(Object.keys(e.current_form_elements).length<=0&&"undefined"!=typeof wph_default_form_elements&&(e.current_form_elements=wph_default_form_elements),0<Object.keys(e.current_form_elements).length&&e.model.set("form_elements",e.current_form_elements)),this.edit_fields_modal.find(".wpmudev-i_close").click()}}),d.hasChanges=!1,d.user_change=function(){d.hasChanges=!0},window.onbeforeunload=function(){if(d.hasChanges)return optin_vars.messages.dont_navigate_away},p(".highlight_input_text").focus(function(){p(this).select()})}(jQuery),function(s){"use strict";var e=window.Module||{};e.Validate={validate_module_name:function(){var e=!0;if(s("input[name=module_name]").length){var t=s("input[name=module_name]"),i=t.next(".wpmudev-label--notice");(e=0!==t.val().length)?i.hasClass("wpmudev-hidden")||i.addClass("wpmudev-hidden"):(t.focus(),i.hasClass("wpmudev-hidden")&&i.removeClass("wpmudev-hidden"))}return e},on_change_validate_module_name:function(e){var t=s(e.target).val(),i=s(e.target).next(".wpmudev-label--notice");0!==t.length?i.hasClass("wpmudev-hidden")||i.addClass("wpmudev-hidden"):i.hasClass("wpmudev-hidden")&&i.removeClass("wpmudev-hidden")}},e.Utils={get_url_param:function(e){for(var t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++){var s=t[i].split("=");if(s[0]===e)return s[1]}return!1},service_supports_fields:function(e,t){return"1"===String(e)||!_.isEmpty(t)&&void 0!==optin_vars.providers[t]&&optin_vars.providers[t].supports_fields}}}(jQuery),Hustle.define("Pop_Up.Content_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-content-tpl"),module_id:0,target_container:i("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:i(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="popup",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return void 0===t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"popup"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-popup-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"popup",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=i(e.target);this.service_modal.add_service(t)},edit_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=i(e.target);this.service_modal.edit_service(t)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Pop_Up.Design_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-design-tpl"),target_container:i("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(e,t){i(this).val(t.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click())},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(e){e.preventDefault();var t=i(e.target).data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(t),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Popup.Listing",function(a){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .import-module-settings":"import_settings","click .hustle-delete-module":"delete_module","click #hustle-free-version-create":"show_upgrade_modal","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .module-duplicate":"duplicate","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","change [name='wph-module-status']":"module_status_updated","change #wph-all-popups":"select_all","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this,e=a(".wpmudev-list .wpmudev-list--element"),o=e.length;e.each(function(){a(this).css("z-index",o),o--;var e=a(this).find(".wpmudev-dots-dropdown"),t=e.find(".wpmudev-dots-button"),i=e.find(".wpmudev-dots-nav");t.on("click",function(){a(this).toggleClass("wpmudev-active"),i.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(i).each(function(){a(this).hasClass("wpmudev-hide")||a(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},delete_module:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=i,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(e){a(e.target).val()?a("#select_file_error").addClass("wpmudev-hidden"):a("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){void 0!==e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},module_status_updated:function(e){var t=this.$(e.target),i=t.val(),s=t.data(),o=t.closest("li.wpmudev-tabs-menu_item");o.addClass("current"),o.siblings().removeClass("current"),s._ajax_nonce=s.nonce,"test"===i?s.action="hustle_popup_toggle_test_activity":(s.action="hustle_popup_module_toggle_state",s.enabled="off"===i?"false":"true"),a.post(ajaxurl,s,function(e){})},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"popup",module_fields:[]}})},set_testmode_visibiliy:function(e,t){void 0===t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_popup_module_toggle_tracking_activity",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})},duplicate:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_popup_duplicate",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})},view_error_log_list:function(e){var t=a(e.currentTarget),i=t.data(),s=i.id,o=i.name,n=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new n({button:t,model:{name:o,id:s,type:"popup",total:i.total}})},select_all:function(e){a(e.target).is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(e){a(e.target);var t=this.$("select#wpmudev-bulk-action").val(),i=this.$('select#wpmudev-bulk-action option[value="'+t+'"]').data("nonce"),s=[];"delete"===t&&(this.$(".wph-module-checkbox:checked").each(function(){s.push(a(this).data("id"))}),_.isEmpty(s)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(s),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=i,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))}})}),Hustle.define("Pop_Up.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"popup"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger");return{Base:e,Content:t,Design:i,Display_Settings:Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"",animation_out:"",after_close:"",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}})}}),Hustle.define("Pop_Up.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Pop_Up.View",function(H,e,t){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-popup-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(e){return this.content_view=e.content_view,this.design_view=e.design_view,this.settings_view=e.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),H(document).off("click","ul.wpmudev-cta-target-options li",H.proxy(this.toggle_cta_options,this)),H(document).off("click","ul.wpmudev-after-submit-options li",H.proxy(this.toggle_submit_options,this)),H(document).off("click","ul.wpmudev-feature-image-position-options li",H.proxy(this.toggle_feature_image_position_options,this)),H(document).off("click","ul.wpmudev-feature-image-fit-options li",H.proxy(this.toggle_feature_image_fit_options,this)),H(document).off("click","ul.wpmudev-feature-image-horizontal-options li",H.proxy(this.toggle_feature_image_horizontal_options,this)),H(document).off("click","ul.wpmudev-feature-image-vertical-options li",H.proxy(this.toggle_feature_image_vertical_options,this)),H(document).off("click","ul.wpmudev-form-fields-icon-options li",H.proxy(this.toggle_form_fields_icon_options,this)),H(document).off("click","ul.wpmudev-form-fields-proximity-options li",H.proxy(this.toggle_form_fields_proximity_options,this)),H(document).off("click","ul.wpmudev-display-triggers li",H.proxy(this.toggle_display_triggers,this)),H(document).off("click",".wpmudev-preview",H.proxy(this.open_preview,this)),H(document).off("click",".hustle-modal-close .hustle-icon",H.proxy(this.close_preview,this)),H(document).off("click",".wpmudev-modal-mask",H.proxy(this.close_preview,this)),H(document).off("click",".wph-reset-color-palette",H.proxy(this.reset_color_palette,this)),H(document).off("keydown",H.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),H(document).on("click","ul.wpmudev-cta-target-options li",H.proxy(this.toggle_cta_options,this)),H(document).on("click","ul.wpmudev-after-submit-options li",H.proxy(this.toggle_submit_options,this)),H(document).on("click","ul.wpmudev-feature-image-position-options li",H.proxy(this.toggle_feature_image_position_options,this)),H(document).on("click","ul.wpmudev-feature-image-fit-options li",H.proxy(this.toggle_feature_image_fit_options,this)),H(document).on("click","ul.wpmudev-feature-image-horizontal-options li",H.proxy(this.toggle_feature_image_horizontal_options,this)),H(document).on("click","ul.wpmudev-feature-image-vertical-options li",H.proxy(this.toggle_feature_image_vertical_options,this)),H(document).on("click","ul.wpmudev-form-fields-icon-options li",H.proxy(this.toggle_form_fields_icon_options,this)),H(document).on("click","ul.wpmudev-form-fields-proximity-options li",H.proxy(this.toggle_form_fields_proximity_options,this)),H(document).on("click","ul.wpmudev-display-triggers li",H.proxy(this.toggle_display_triggers,this)),H(document).on("click",".wpmudev-preview",H.proxy(this.open_preview,this)),H(document).on("click",".hustle-modal-close .hustle-icon",H.proxy(this.close_preview,this)),H(document).on("click",".wpmudev-modal-mask",H.proxy(this.close_preview,this)),H(document).on("click",".wph-reset-color-palette",H.proxy(this.reset_color_palette,this)),H(document).on("change keyup keypress","input[name=module_name]",H.proxy(this.validate_modal_name,this)),H(document).on("keydown",H.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",H.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"),10);this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var e=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");e.length&&e.remove();var i=this,t=i.content_view.model.get("main_content"),s=H(".wpmudev-preview").data("nonce");-1===t.search(/\[/g)?i.render_preview(i.content_view.model.toJSON()):H.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:t,_ajax_nonce:s},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});o.unique_id="",t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var e=this,t=this.$("#wph-preview-modal").addClass("wpmudev-modal-active").find(".hustle-modal"),i=this.settings_view.model.get("animation_in");H("body").addClass("wpmudev-modal-is_active"),t.hasClass("hustle-animated")?setTimeout(function(){t.addClass("hustle-animate-"+i),e.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style;if(_.isTrue(e.use_email_collection))this.apply_preview_optin_styles();else{var s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-body section"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find(".hustle-modal-image"),c=o.find("article, .hustle-modal-message"),u=o.find("article blockquote, .hustle-modal-message blockquote"),p=o.find("article a, .hustle-modal-message a"),m=o.find(".hustle-modal-cta"),h=o.find(".hustle-modal-close"),v=o.find(".hustle-modal-close svg path"),g=s.find(".wpmudev-modal-mask");"cabriolet"===i?a.css("background-color",t.main_bg_color):n.css("background-color",t.main_bg_color),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("background-color",t.image_container_bg),c.css("color",t.content_color),u.css("border-left-color",t.link_static_color),u.mouseover(function(){H(this).css("border-left-color",t.link_hover_color)}).mouseout(function(){H(this).css("border-left-color",t.link_static_color)}),p.css("color",t.link_static_color),p.mouseover(function(){H(this).css("color",t.link_hover_color)}).mouseout(function(){H(this).css("color",t.link_static_color)}),m.css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color}),m.mouseover(function(){H(this).css({"background-color":t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){H(this).css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color})}),v.css("fill",t.close_button_static_color),h.mouseover(function(){v.css("fill",t.close_button_hover_color)}).mouseout(function(){v.css("fill",t.close_button_static_color)}),g.css("background-color",t.overlay_bg);var f=s.find(".hustle-modal-image img"),w="",b="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||(w="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,b="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,f.css({"background-position":w+" "+b,"object-position":w+" "+b})),_.isTrue(t.border)){var y=t.border_weight+"px "+t.border_type+" "+t.border_color;"cabriolet"===i?o.find("section").css({border:y,"border-radius":t.border_radius+"px"}):n.css({border:y,"border-radius":t.border_radius+"px"})}if(_.isTrue(t.drop_shadow)){var x=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;"cabriolet"===i?o.find("section").css({"box-shadow":x}):n.css({"box-shadow":x})}}},apply_preview_optin_styles:function(){this.content_view.model.toJSON();var e=this.design_view.model.toJSON(),t=e.form_layout,i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=s.find(".hustle-modal-body"),n=s.find(".hustle-modal-success"),a=s.find(".hustle-modal-title"),l=s.find(".hustle-modal-subtitle"),d=s.find("article"),r=s.find("article blockquote"),c=s.find("article a:not(.hustle-modal-cta)"),u=s.find(".hustle-modal-optin_field"),p=u.find("label .hustle-modal-optin_icon .hustle-icon path"),m=u.find("label .hustle-modal-optin_placeholder"),h=s.find(".hustle-modal-optin_button button"),v=s.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),g=s.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),f=s.find(".hustle-modal-close"),w=s.find(".hustle-modal-close svg path");o.css("background-color",e.main_bg_color),n.css("background-color",e.main_bg_color),o.find(".hustle-modal-image").css("background-color",e.image_container_bg),"one"===t||"two"===t?s.find("footer").css("background-color",e.form_area_bg):s.find(".hustle-modal-optin_wrap").css("background-color",e.form_area_bg),a.css("color",e.title_color),l.css("color",e.subtitle_color),d.css("color",e.content_color),r.css("border-left-color",e.link_static_color),c.css("color",e.link_static_color),c.mouseover(function(){H(this).css("color",e.link_hover_color)}).mouseout(function(){H(this).css("color",e.link_static_color)}),d.find(".hustle-modal-cta").css({background:e.cta_button_static_bg,color:e.cta_button_static_color}),d.find(".hustle-modal-cta").mouseover(function(){H(this).css({background:e.cta_button_hover_bg,color:e.cta_button_hover_color})}).mouseout(function(){H(this).css({background:e.cta_button_static_bg,color:e.cta_button_static_color})}),u.find("input").css("color",e.optin_form_field_text_static_color),u.css("background-color",e.optin_input_static_bg),u.mouseover(function(){H(this).find("input").css("color",e.optin_form_field_text_hover_color),H(this).css("background-color",e.optin_input_hover_bg)}).mouseout(function(){H(this).find("input").css("color",e.optin_form_field_text_static_color),H(this).css("background-color",e.optin_input_static_bg)}),p.css("fill",e.optin_input_icon),h.css("color",e.optin_submit_button_static_color),h.css("background-color",e.optin_submit_button_static_bg),h.mouseover(function(){H(this).css("color",e.optin_submit_button_hover_color),H(this).css("background-color",e.optin_submit_button_hover_bg)}).mouseout(function(){H(this).css("color",e.optin_submit_button_static_color),H(this).css("background-color",e.optin_submit_button_static_bg)}),m.css("color",e.optin_placeholder_color),v.css("background-color",e.optin_check_radio_static_bg),g.css("background-color",e.optin_check_radio_static_bg);var b=H("#hustle-module-checkbox-radio-custom-styles"),y=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before { color: "+e.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before { color: "+e.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before { color: "+e.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before { color: "+e.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label { color: "+e.optin_mailchimp_title_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label { color: "+e.optin_mailchimp_labels_color+"; }.wpmudev-ui .wpmudev-modal .wpmudev-modal-mask { background-color: "+e.overlay_bg+"; }";b.length&&b.remove(),H('<style id="hustle-module-mailchimp-custom-styles">'+y+"</style>").appendTo("body"),w.css("fill",e.close_button_static_color),f.mouseover(function(){w.css("fill",e.close_button_hover_color)}).mouseout(function(){w.css("fill",e.close_button_static_color)});var x=i.find(".hustle-modal-image img"),C="",k="";if("contain"!==e.feature_image_fit&&"cover"!==e.feature_image_fit||(C="custom"===e.feature_image_horizontal?e.feature_image_horizontal_px+"px":e.feature_image_horizontal,k="custom"===e.feature_image_vertical?e.feature_image_vertical_px+"px":e.feature_image_vertical,x.css({"background-position":C+" "+k,"object-position":C+" "+k})),_.isTrue(e.border)){var $=e.border_weight+"px "+e.border_type+" "+e.border_color;o.css({border:$,"border-radius":e.border_radius+"px"})}if(_.isTrue(e.drop_shadow)){var S=e.drop_shadow_x+"px "+e.drop_shadow_y+"px "+e.drop_shadow_blur+"px "+e.drop_shadow_spread+"px "+e.drop_shadow_color;o.css({"box-shadow":S})}if(_.isTrue(e.form_fields_border)){var O=e.form_fields_border_weight+"px "+e.form_fields_border_type+" "+e.form_fields_border_color;u.css({border:O,"border-radius":e.form_fields_border_radius+"px"})}if(_.isTrue(e.button_border)){var z=e.button_border_weight+"px "+e.button_border_type+" "+e.button_border_color;h.css({border:z,"border-radius":e.button_border_radius+"px"})}},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal").find(".hustle-modal"),n=o.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(o.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var a=o.find(".hustle-modal-close").height()+15,l=o.find(".hustle-modal-content");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),l.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var d=o.find("section"),r=o.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)c=0;else var c=o.find("header").outerHeight();if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var u=o.find("footer").innerHeight();else u=0;d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){c=o.find("header").height()+20,d=o.find("section"),r=o.find(".hustle-modal-message");d.css({height:"calc("+t.custom_height+"px - "+c+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+c+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var p=o.find(".hustle-modal-image"),m=(d=o.find("section"),o.find("article"));if(d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),d.hasClass("hustle-modal-image_above")||d.hasClass("hustle-modal-image_below")){t.custom_height;d.height()<250?d.css({"overflow-y":"auto"}):m.css({height:"calc("+d.height()+"px - "+p.height()+"px)","overflow-y":"auto"})}else m.css({"max-height":"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"}),p.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var h=o.find(".hustle-modal-body");d=o.find("section"),m=o.find("article");h.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var v=o.find(".hustle-modal-image").height();m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,v=o.find(".hustle-modal-image").height();var g=t.custom_height-a-v,f=o.find(".hustle-modal-optin_wrap");m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"}),f.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"}),o.find(".hustle-modal-optin_form").innerHeight()>g&&f.css({"align-items":"flex-start"})}}},apply_custom_css:function(){H("#hustle-module-custom-styles").remove();var e=this.design_view.model.toJSON().customize_css;if(1===e||"1"===e){var t=this.design_view.model.get("custom_css"),i=H("#hustle_custom_css").data("nonce");if(_.isEmpty(t)||void 0===i)return;H.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_popup_prepare_custom_css",css:t,_ajax_nonce:i},success:function(e){if(e&&e.success){var t=H("#hustle-module-custom-styles");t.length&&t.remove(),H('<style id="hustle-module-custom-styles">'+e.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(e){e.stopPropagation();var t=this.$("#wph-preview-modal"),i=t.find(".hustle-modal"),s="hustle-animate-"+this.settings_view.model.get("animation_in"),o=this.settings_view.model.get("animation_out"),n="hustle-animate-"+o,a=1e3;i.removeClass(s).addClass(n),i.hasClass("hustle-animated")&&("fadeOut"===o&&(a=305),"newspaperOut"===o&&(a=505),"bounceOut"===o&&(a=755),setTimeout(function(){t.removeClass("wpmudev-modal-active"),H("body").removeClass("wpmudev-modal-is_active"),i.removeClass(n)},a)),i.hasClass("hustle-modal-static")&&(i.removeClass("hustle-modal-static"),t.removeClass("wpmudev-modal-active"),H("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},provider_add_custom_fields:function(e,t,i,s){var o=s.content_view.model.get("active_email_service");if(!0===Module.Utils.service_supports_fields(0,o)&&("form_elements"in i||"email_services"in i||"active_email_service"in i)&&"object"==typeof s.content_view.model.get("form_elements")){var n={action:"add_module_fields",_ajax_nonce:t,data:JSON.stringify(s.content_view.model.get("form_elements")),provider:o=s.content_view.model.get("active_email_service"),module_id:e};H.post(ajaxurl,n,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(e){if(!Module.Validate.validate_module_name())return!1;var t=this.content_view.model.changed;this.set_content_from_tinymce(!0),this.sanitize_data();var i=this,s=e.data("id")?e.data("id"):"-1",o=e.data("nonce"),n=this.model.toJSON(),a=this.content_view.model.toJSON(),l=this.design_view.model.toJSON(),d=this.settings_view.model.toJSON();return H.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_popup_module",_ajax_nonce:o,id:s,module:n,content:a,design:l,settings:d,shortcode_id:i._get_shortcode_id()},complete:function(e){i.provider_add_custom_fields(s,o,t,i);e.responseJSON}})},save_changes:function(e){e.preventDefault();var s=this,o=H(e.currentTarget);s.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(o);t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=window.location.pathname+window.location.search;if(-1===t.indexOf("&id=")&&(t=t+"&id="+e.data,window.history.replaceState({},"",t),s.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){H(this).attr("href",H(this).data("link")+"&id="+e.data)})),o.data("id",e.data),o.siblings().data("id",e.data),Module.hasChanges=!1,"settings"===(optin_vars.current.section||!1)){var i=e.data;return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+i)}}}).always(function(){s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(e){e.preventDefault();var o=this;o.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(H(e.currentTarget));t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,i=optin_vars.current.section||!1,s="";return window.onbeforeunload=null,i&&"content"!==i?"design"===i&&(s=o.$(".wpmudev-menu-settings-link a").data("link")):s=o.$(".wpmudev-menu-design-link a").data("link"),-1===s.indexOf("&id")&&(s+="&id="+t),window.location.replace(s)}}):o.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(e){e.preventDefault();this.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var t=this.save(H(e.currentTarget));t?t.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):this.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();this.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var t=optin_vars.current.section;window.onbeforeunload=null,"design"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===t&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t,i=e.changed,s=Object.keys(i);"has_title"in i&&((t=this.$("#wph-wizard-content-title-textboxes")).length&&(i.has_title?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"use_feature_image"in i&&((t=this.$("#wph-wizard-content-image-options")).length&&(i.use_feature_image?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_cta"in i&&((t=this.$("#wph-wizard-content-cta-options")).length&&(i.show_cta?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_gdpr"in i&&((t=this.$("#wph-wizard-content-gdpr-message")).length&&(i.show_gdpr?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));("use_email_collection"in i&&this.use_email_collection_changed(i.use_email_collection,!0),"after_successful_submission"in i&&this.after_successful_submission_changed(i.after_successful_submission),"auto_close_success_message"in i)&&((t=this.$("#wph-wizard-content-form_success_options")).length&&(i.auto_close_success_message?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));"save_local_list"in i&&((t=this.$("#wph-wizard-content-local_list_name")).length&&(i.save_local_list?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));if(-1!==s[0].indexOf("_service_provider")){var o=s[0].replace("_service_provider","");this.handle_email_service(o,i[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}"feature_image_fit"in t&&((s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options")).length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_horizontal"in t&&((s=this.$("#wph-wizard-design-horizontal-position")).length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_vertical"in t&&((s=this.$("#wph-wizard-design-vertical-position")).length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"border"in t&&((s=this.$("#wph-wizard-design-border-options")).length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"form_fields_border"in t&&((s=this.$("#wph-wizard-design-form-fields-border-options")).length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"button_border"in t&&((s=this.$("#wph-wizard-design-button-border-options")).length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"drop_shadow"in t&&((s=this.$("#wph-wizard-design-shadow-options")).length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_size"in t&&((s=this.$("#wph-wizard-design-size-options")).length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_css"in t&&((s=this.$("#wph-wizard-design-css_holder")).length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))))},settings_view_changed:function(e){var t,i=e.changed;"on_time"in i&&((t=this.$("#wpmudev-display-trigger-time-options")).length&&(i.on_time?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.removeClass("wpmudev-show"),t.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",i.on_time,{silent:!0}));if("on_scroll"in i){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",i.on_scroll,{silent:!0})}("on_adblock"in i&&this.settings_view.model.set("triggers.on_adblock",i.on_adblock,{silent:!0}),"on_exit_intent_delayed"in i)&&((t=this.$("#wpmudev-display-exit-intent-delayed-options")).length&&(i.on_exit_intent_delayed?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.removeClass("wpmudev-show"),t.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",i.on_exit_intent_delayed,{silent:!0}))},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var i=this;if(parseInt(this.content_view.model.get("use_email_collection"),10)){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var i=this,e=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_");if(parseInt(this.content_view.model.get("use_email_collection"),10)){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-form_submission"),a=this.$("#wph-wizard-content-form_message"),l=this.$("#wph-wizard-content-form_success");parseInt(e,10)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),l.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("cta_target",i.val(),{silent:!0})},toggle_submit_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",i.val())},toggle_feature_image_position_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",i.val(),{silent:!0})},toggle_feature_image_fit_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",i.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",i.val(),{silent:!1})},toggle_feature_image_vertical_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",i.val(),{silent:!1})},toggle_form_fields_icon_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",i.val(),{silent:!1})},toggle_form_fields_proximity_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",i.val(),{silent:!1})},toggle_display_triggers:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",i.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(i,e){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),e?(this.content_view.model.set("active_email_service",i),_.isEmpty(s)?s[i]={enabled:e}:_.each(s,function(e,t){t===i?s[t]=_.extend(s[t],{enabled:1}):(s[t]=_.extend(s[t],{enabled:0}),H('input[data-attribute="'+t+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[i]=_.extend(s[i],{enabled:e})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model.get("auto_close_success_message"),i=this.content_view.model.get("auto_close_time"),s=this.content_view.model.get("auto_close_unit"),o=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(t)){var n=parseInt(i);"minutes"===s&&(n*=60),n*=1e3,_.delay(function(){var e=o.find(".hustle-modal").find(".hustle-modal-close .hustle-icon");0<e.length?e.trigger("click"):$success_msg.removeAttr("style")},n)}}})}),Hustle.define("Slidein.Content_View",function(n,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-content-tpl"),module_id:0,target_container:n("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:n(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="slidein",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return void 0===t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"slidein"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-slidein-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"slidein",target_div:t}),t.html(""),t.html(this.media_holder.$el))},show_email_service_modal:function(e){var t=n("#wph-add-new-service-modal").find(".wpmudev-box-modal"),i=this.model.get("email_services"),s=n("#optin-provider-account-selected-list"),o=this;this.add_service_modal.addClass("wpmudev-modal-active"),n("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){t.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",o),n(document).off("click",".optin_refresh_provider_details",n.proxy(o.refresh_provider_details,o)),n(document).on("click",".optin_refresh_provider_details",n.proxy(o.refresh_provider_details,o)),n(document).off("click",".wph-save-optin-service",n.proxy(o.updated_email_service_args,o)),n(document).on("click",".wph-save-optin-service",n.proxy(o.updated_email_service_args,o)),Hustle.Events.off("slidein.optin.service.saved",n.proxy(o.save_email_service,o)),Hustle.Events.on("slidein.optin.service.saved",n.proxy(o.save_email_service,o)),o.hide_or_show_other_services(e),e&&!_.isEmpty(i)?Hustle.Events.trigger("optin.service.show.selected",o):s.hide()},100)},add_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=n(e.target);this.service_modal.add_service(t)},edit_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=n(e.target);this.service_modal.edit_service(t)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Slidein.Design_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-design-tpl"),target_container:i("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(e,t){i(this).val(t.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(e){e.preventDefault();var t=i(e.target).data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(t),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Slidein.Listing",function(a){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .import-module-settings":"import_settings","click .hustle-delete-module":"delete_module","click #hustle-free-version-create":"show_upgrade_modal","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","click .module-duplicate":"duplicate","change [name='wph-module-status']":"module_status_updated","change #wph-all-slideins":"select_all","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this,e=a(".wpmudev-list .wpmudev-list--element"),o=e.length;e.each(function(){a(this).css("z-index",o),o--;var e=a(this).find(".wpmudev-dots-dropdown"),t=e.find(".wpmudev-dots-button"),i=e.find(".wpmudev-dots-nav");t.on("click",function(){a(this).toggleClass("wpmudev-active"),i.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(i).each(function(){a(this).hasClass("wpmudev-hide")||a(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},delete_module:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=i,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(e){a(e.target).val()?a("#select_file_error").addClass("wpmudev-hidden"):a("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){void 0!==e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"slidein",module_fields:[]}})},set_testmode_visibiliy:function(e,t){void 0===t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_slidein_module_toggle_tracking_activity",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})},view_error_log_list:function(e){var t=a(e.currentTarget),i=t.data(),s=i.id,o=i.name,n=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new n({button:t,model:{name:o,id:s,type:"slidein",total:i.total}})},module_status_updated:function(e){var t=this.$(e.target),i=t.val(),s=t.data(),o=t.closest("li.wpmudev-tabs-menu_item");o.addClass("current"),o.siblings().removeClass("current"),s._ajax_nonce=s.nonce,"test"===i?s.action="hustle_slidein_toggle_test_activity":(s.action="hustle_slidein_module_toggle_state",s.enabled="off"===i?"false":"true"),a.post(ajaxurl,s,function(e){})},select_all:function(e){a(e.target).is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(e){a(e.target);var t=this.$("select#wpmudev-bulk-action").val(),i=this.$('select#wpmudev-bulk-action option[value="'+t+'"]').data("nonce"),s=[];"delete"===t&&(this.$(".wph-module-checkbox:checked").each(function(){s.push(a(this).data("id"))}),_.isEmpty(s)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(s),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=i,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))},duplicate:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_slidein_duplicate",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})}})}),Hustle.define("Slidein.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"slidein"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger");return{Base:e,Content:t,Design:i,Display_Settings:Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"slideInUp",animation_out:"slideOutUp",after_close:"",display_position:"s",auto_hide:!1,auto_hide_time:5,auto_hide_unit:"hours",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}})}}),Hustle.define("Slidein.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Slidein.View",function(T,e,t){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-slidein-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(e){return this.content_view=e.content_view,this.design_view=e.design_view,this.settings_view=e.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),T(document).off("click","ul.wpmudev-cta-target-options li",T.proxy(this.toggle_cta_options,this)),T(document).off("click","ul.wpmudev-after-submit-options li",T.proxy(this.toggle_submit_options,this)),T(document).off("click","ul.wpmudev-feature-image-position-options li",T.proxy(this.toggle_feature_image_position_options,this)),T(document).off("click","ul.wpmudev-feature-image-fit-options li",T.proxy(this.toggle_feature_image_fit_options,this)),T(document).off("click","ul.wpmudev-feature-image-horizontal-options li",T.proxy(this.toggle_feature_image_horizontal_options,this)),T(document).off("click","ul.wpmudev-feature-image-vertical-options li",T.proxy(this.toggle_feature_image_vertical_options,this)),T(document).off("click","ul.wpmudev-form-fields-icon-options li",T.proxy(this.toggle_form_fields_icon_options,this)),T(document).off("click","ul.wpmudev-form-fields-proximity-options li",T.proxy(this.toggle_form_fields_proximity_options,this)),T(document).off("click","ul.wpmudev-display-triggers li",T.proxy(this.toggle_display_triggers,this)),T(document).off("click",".wpmudev-preview",T.proxy(this.open_preview,this)),T(document).off("click",".hustle-modal-close .hustle-icon",T.proxy(this.close_preview,this)),T(document).off("click",".wpmudev-modal-mask",T.proxy(this.close_preview,this)),T(document).off("click",".wph-reset-color-palette",T.proxy(this.reset_color_palette,this)),T(document).off("keydown",T.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),T(document).on("click","ul.wpmudev-cta-target-options li",T.proxy(this.toggle_cta_options,this)),T(document).on("click","ul.wpmudev-after-submit-options li",T.proxy(this.toggle_submit_options,this)),T(document).on("click","ul.wpmudev-feature-image-position-options li",T.proxy(this.toggle_feature_image_position_options,this)),T(document).on("click","ul.wpmudev-feature-image-fit-options li",T.proxy(this.toggle_feature_image_fit_options,this)),T(document).on("click","ul.wpmudev-feature-image-horizontal-options li",T.proxy(this.toggle_feature_image_horizontal_options,this)),T(document).on("click","ul.wpmudev-feature-image-vertical-options li",T.proxy(this.toggle_feature_image_vertical_options,this)),T(document).on("click","ul.wpmudev-feature-image-location li",T.proxy(this.toggle_feature_image_options,this)),T(document).on("click","ul.wpmudev-form-fields-icon-options li",T.proxy(this.toggle_form_fields_icon_options,this)),T(document).on("click","ul.wpmudev-form-fields-proximity-options li",T.proxy(this.toggle_form_fields_proximity_options,this)),T(document).on("click","ul.wpmudev-display-triggers li",T.proxy(this.toggle_display_triggers,this)),T(document).on("click",".wpmudev-preview",T.proxy(this.open_preview,this)),T(document).on("click",".hustle-modal-close .hustle-icon",T.proxy(this.close_preview,this)),T(document).on("click",".wpmudev-modal-mask",T.proxy(this.close_preview,this)),T(document).on("click",".wph-reset-color-palette",T.proxy(this.reset_color_palette,this)),T(document).on("change keyup keypress","input[name=module_name]",T.proxy(this.validate_modal_name,this)),T(document).on("keydown",T.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",T.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal").find(".hustle-modal"),n=o.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(o.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var a=o.find(".hustle-modal-close").height()+15,l=o.find(".hustle-modal-content");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),l.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var d=o.find("section"),r=o.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)c=0;else var c=o.find("header").outerHeight();if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var u=o.find("footer").innerHeight();else u=0;d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){c=o.find("header").height()+20,d=o.find("section"),r=o.find(".hustle-modal-message");d.css({height:"calc("+t.custom_height+"px - "+c+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+c+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var p=o.find(".hustle-modal-image"),m=(d=o.find("section"),o.find("article"));if(d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),d.hasClass("hustle-modal-image_above")||d.hasClass("hustle-modal-image_below")){t.custom_height;d.height()<250?d.css({"overflow-y":"auto"}):m.css({height:"calc("+d.height()+"px - "+p.height()+"px)","overflow-y":"auto"})}else m.css({"max-height":"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"}),p.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var h=o.find(".hustle-modal-body");d=o.find("section"),m=o.find("article");h.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var v=o.find(".hustle-modal-image").height();m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,v=o.find(".hustle-modal-image").height();var g=t.custom_height-a-v,f=o.find(".hustle-modal-optin_wrap");m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"}),f.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"}),o.find(".hustle-modal-optin_form").innerHeight()>g&&f.css({"align-items":"flex-start"})}}},apply_custom_css:function(){T("#hustle-module-custom-styles").remove();var e=this.design_view.model.toJSON().customize_css;if(1===e||"1"===e){var t=this.design_view.model.get("custom_css"),i=T("#hustle_custom_css").data("nonce");if(_.isEmpty(t)||void 0===i)return;T.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_slidein_prepare_custom_css",css:t,_ajax_nonce:i},success:function(e){if(e&&e.success){var t=T("#hustle-module-custom-styles");t.length&&t.remove(),T('<style id="hustle-module-custom-styles">'+e.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(e){e.stopPropagation();var t=this.$("#wph-preview-modal"),i=t.find(".hustle-modal"),s=this.get_slide_in_direction(this.settings_view.model.get("display_position"),"out"),o="hustle-animate-slideIn"+s,n="hustle-animate-slideOut"+s;i.removeClass(o).addClass(n),setTimeout(function(){t.removeClass("wpmudev-modal-active"),T("body").removeClass("wpmudev-modal-is_active"),i.removeClass(n)},1e3)},get_slide_in_direction:function(e,t){return"nw"===e||"w"===e||"sw"===e?"Left":"ne"===e||"e"===e||"se"===e?"Right":"s"===e&&"in"===t||"n"===e&&"out"===t?"Up":"Down"},provider_add_custom_fields:function(e,t,i,s){var o=s.content_view.model.get("active_email_service");if(!0===Module.Utils.service_supports_fields(0,o)&&("form_elements"in i||"email_services"in i||"active_email_service"in i)&&"object"==typeof s.content_view.model.get("form_elements")){var n={action:"add_module_fields",_ajax_nonce:t,data:JSON.stringify(s.content_view.model.get("form_elements")),provider:o=s.content_view.model.get("active_email_service"),module_id:e};T.post(ajaxurl,n,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(e){if(!Module.Validate.validate_module_name())return!1;var t=this.content_view.model.changed;if(this.set_content_from_tinymce(!0),this.sanitize_data(),"undefined"!=typeof tinyMCE){var i=tinyMCE.get("main_content"),s=this.$("textarea#main_content"),o="true"===s.attr("aria-hidden")?i.getContent():s.val();this.content_view.model.set("main_content",o,{silent:!0});var n=tinyMCE.get("success_message"),a=this.$("textarea#success_message"),l="true"===a.attr("aria-hidden")?n.getContent():a.val();this.content_view.model.set("success_message",l,{silent:!0})}var d=this,r=e.data("id")?e.data("id"):"-1",c=e.data("nonce"),_=this.model.toJSON(),u=this.content_view.model.toJSON(),p=this.design_view.model.toJSON(),m=this.settings_view.model.toJSON();return T.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_slidein_module",_ajax_nonce:c,id:r,module:_,content:u,design:p,settings:m,shortcode_id:d._get_shortcode_id()},complete:function(e){d.provider_add_custom_fields(r,c,t,d);e.responseJSON}})},save_changes:function(e){e.preventDefault();var s=this,o=T(e.currentTarget);s.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(o);t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=window.location.pathname+window.location.search;if(-1===t.indexOf("&id=")&&(t=t+"&id="+e.data,window.history.replaceState({},"",t),s.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){T(this).attr("href",T(this).data("link")+"&id="+e.data)})),o.data("id",e.data),o.siblings().data("id",e.data),Module.hasChanges=!1,"settings"===(optin_vars.current.section||!1)){var i=e.data;return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+i)}}}).always(function(){s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(e){e.preventDefault();var o=this;o.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(T(e.currentTarget));t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,i=optin_vars.current.section,s="";return window.onbeforeunload=null,i&&"content"!==i?"design"===i&&(s=o.$(".wpmudev-menu-settings-link a").data("link")):s=o.$(".wpmudev-menu-design-link a").data("link"),-1===s.indexOf("&id")&&(s+="&id="+t),window.location.replace(s)}}):o.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(e){e.preventDefault();this.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var t=this.save(T(e.currentTarget));t?t.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,void window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):this.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();this.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var t=optin_vars.current.section;window.onbeforeunload=null,"design"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===t&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t,i=e.changed,s=Object.keys(i);"has_title"in i&&((t=this.$("#wph-wizard-content-title-textboxes")).length&&(i.has_title?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"use_feature_image"in i&&((t=this.$("#wph-wizard-content-image-options")).length&&(i.use_feature_image?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_cta"in i&&((t=this.$("#wph-wizard-content-cta-options")).length&&(i.show_cta?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_gdpr"in i&&((t=this.$("#wph-wizard-content-gdpr-message")).length&&(i.show_gdpr?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));("use_email_collection"in i&&this.use_email_collection_changed(i.use_email_collection),"after_successful_submission"in i&&this.after_successful_submission_changed(i.after_successful_submission),"auto_close_success_message"in i)&&((t=this.$("#wph-wizard-content-form_success_options")).length&&(i.auto_close_success_message?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));"save_local_list"in i&&((t=this.$("#wph-wizard-content-local_list_name")).length&&(i.save_local_list?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));if(-1!==s[0].indexOf("_service_provider")){var o=s[0].replace("_service_provider","");this.handle_email_service(o,i[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}"feature_image_fit"in t&&((s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options")).length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_horizontal"in t&&((s=this.$("#wph-wizard-design-horizontal-position")).length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_vertical"in t&&((s=this.$("#wph-wizard-design-vertical-position")).length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"border"in t&&((s=this.$("#wph-wizard-design-border-options")).length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"form_fields_border"in t&&((s=this.$("#wph-wizard-design-form-fields-border-options")).length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"button_border"in t&&((s=this.$("#wph-wizard-design-button-border-options")).length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"drop_shadow"in t&&((s=this.$("#wph-wizard-design-shadow-options")).length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_size"in t&&((s=this.$("#wph-wizard-design-size-options")).length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_css"in t&&((s=this.$("#wph-wizard-design-css_holder")).length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))))},update_color_palette:function(e){var i=this;if(parseInt(this.content_view.model.get("use_email_collection"))){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var i=this,e=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_");if(parseInt(this.content_view.model.get("use_email_collection"),10)){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-form_submission"),a=this.$("#wph-wizard-content-form_message"),l=this.$("#wph-wizard-content-form_success");parseInt(e)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),l.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_feature_image_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("feature_image_location",i.val(),{silent:!0})},toggle_cta_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("cta_target",i.val(),{silent:!0})},toggle_submit_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",i.val())},toggle_feature_image_position_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",i.val(),{silent:!0})},toggle_feature_image_fit_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",i.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",i.val(),{silent:!1})},toggle_feature_image_vertical_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",i.val(),{silent:!1})},toggle_form_fields_icon_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",i.val(),{silent:!1})},toggle_form_fields_proximity_options:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",i.val(),{silent:!1})},toggle_display_triggers:function(e){var t=T(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",i.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},settings_view_changed:function(e){var t,i=e.changed;"on_time"in i&&((t=this.$("#wpmudev-display-trigger-time-options")).length&&(i.on_time?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.removeClass("wpmudev-show"),t.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",i.on_time,{silent:!0}));if("on_scroll"in i){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",i.on_scroll,{silent:!0})}"on_exit_intent_delayed"in i&&((t=this.$("#wpmudev-display-exit-intent-delayed-options")).length&&(i.on_exit_intent_delayed?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.removeClass("wpmudev-show"),t.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",i.on_exit_intent_delayed,{silent:!0}));("on_adblock"in i&&this.settings_view.model.set("triggers.on_adblock",i.on_adblock,{silent:!0}),"auto_hide"in i)&&((t=this.$("#wpmudev-display-auto_hide-options")).length&&(i.auto_hide?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.removeClass("wpmudev-show"),t.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.auto_hide",i.auto_hide,{silent:!0}));"display_position"in i&&this.settings_view.model.set("display_position",i.display_position,{silent:!0})},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var e=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");e.length&&e.remove();var i=this,t=i.content_view.model.get("main_content"),s=T(".wpmudev-preview").data("nonce");-1===t.search(/\[/g)?i.render_preview(i.content_view.model.toJSON()):T.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:t,_ajax_nonce:s},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});o.unique_id="",t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var e=this,t=this.$("#wph-preview-modal").removeClass("inc_opt_slidein_nw inc_opt_slidein_n inc_opt_slidein_ne inc_opt_slidein_w inc_opt_slidein_e inc_opt_slidein_sw inc_opt_slidein_s inc_opt_slidein_se").addClass("wpmudev-modal-active inc_opt_slidein_"+this.settings_view.model.get("display_position")).find(".hustle-modal"),i="hustle-animate-slideIn"+this.get_slide_in_direction(this.settings_view.model.get("display_position"),"in");T("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){t.addClass(i),e.apply_custom_size()},100)},apply_preview_styles:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style;if(_.isTrue(e.use_email_collection))this.apply_preview_optin_styles();else{var s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-body section"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find(".hustle-modal-image"),c=o.find("article, .hustle-modal-message"),u=o.find("article blockquote, .hustle-modal-message blockquote"),p=o.find("article a, .hustle-modal-message a"),m=o.find(".hustle-modal-cta"),h=o.find(".hustle-modal-close"),v=o.find(".hustle-modal-close svg path"),g=o.find(".wpmudev-modal-mask");"cabriolet"===i?a.css("background-color",t.main_bg_color):n.css("background-color",t.main_bg_color),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("background-color",t.image_container_bg),c.css("color",t.content_color),u.css("border-left-color",t.link_static_color),u.mouseover(function(){T(this).css("border-left-color",t.link_hover_color)}).mouseout(function(){T(this).css("border-left-color",t.link_static_color)}),p.css("color",t.link_static_color),p.mouseover(function(){T(this).css("color",t.link_hover_color)}).mouseout(function(){T(this).css("color",t.link_static_color)}),m.css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color}),m.mouseover(function(){T(this).css({"background-color":t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){T(this).css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color})}),v.css("fill",t.close_button_static_color),h.mouseover(function(){v.css("fill",t.close_button_hover_color)}).mouseout(function(){v.css("fill",t.close_button_static_color)}),g.css("background-color",t.overlay_bg);var f=s.find(".hustle-modal-image img"),w="",b="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||(w="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,b="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,f.css("object-position",w+" "+b)),"right"===e.feature_image_location&&r.addClass("hustle-modal-image-right"),_.isTrue(t.border)){var y=t.border_weight+"px "+t.border_type+" "+t.border_color;"cabriolet"===i?o.find("section").css({border:y,"border-radius":t.border_radius+"px"}):n.css({border:y,"border-radius":t.border_radius+"px"})}if(_.isTrue(t.drop_shadow)){var x=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;"cabriolet"===i?o.find("section").css({"box-shadow":x}):n.css({"box-shadow":x})}}},apply_preview_optin_styles:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.form_layout,s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-success"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find("article"),c=o.find("article blockquote"),u=o.find("article a:not(.hustle-modal-cta)"),p=o.find(".hustle-modal-image"),m=o.find(".hustle-modal-optin_field"),h=m.find("label .hustle-modal-optin_icon .hustle-icon path"),v=m.find("label .hustle-modal-optin_placeholder"),g=o.find(".hustle-modal-optin_button button"),f=o.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),w=o.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),b=o.find(".hustle-modal-close"),y=o.find(".hustle-modal-close svg path");n.css("background-color",t.main_bg_color),a.css("background-color",t.main_bg_color),n.find(".hustle-modal-image").css("background-color",t.image_container_bg),"one"===i||"two"===i?o.find("footer").css("background-color",t.form_area_bg):o.find(".hustle-modal-optin_wrap").css("background-color",t.form_area_bg),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("color",t.content_color),c.css("border-left-color",t.link_static_color),u.css("color",t.link_static_color),u.mouseover(function(){T(this).css("color",t.link_hover_color)}).mouseout(function(){T(this).css("color",t.link_static_color)}),r.find(".hustle-modal-cta").css({background:t.cta_button_static_bg,color:t.cta_button_static_color}),r.find(".hustle-modal-cta").mouseover(function(){T(this).css({background:t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){T(this).css({background:t.cta_button_static_bg,color:t.cta_button_static_color})}),m.find("input").css("color",t.optin_form_field_text_static_color),m.css("background-color",t.optin_input_static_bg),m.mouseover(function(){T(this).find("input").css("color",t.optin_form_field_text_hover_color),T(this).css("background-color",t.optin_input_hover_bg)}).mouseout(function(){T(this).find("input").css("color",t.optin_form_field_text_static_color),T(this).css("background-color",t.optin_input_static_bg)}),h.css("fill",t.optin_input_icon),g.css("color",t.optin_submit_button_static_color),g.css("background-color",t.optin_submit_button_static_bg),g.mouseover(function(){T(this).css("color",t.optin_submit_button_hover_color),T(this).css("background-color",t.optin_submit_button_hover_bg)}).mouseout(function(){T(this).css("color",t.optin_submit_button_static_color),T(this).css("background-color",t.optin_submit_button_static_bg)}),v.css("color",t.optin_placeholder_color),f.css("background-color",t.optin_check_radio_static_bg),w.css("background-color",t.optin_check_radio_static_bg);var x=T("#hustle-module-checkbox-radio-custom-styles"),C=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before { color: "+t.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before { color: "+t.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before { color: "+t.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before { color: "+t.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label { color: "+t.optin_mailchimp_title_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label { color: "+t.optin_mailchimp_labels_color+"; }.wpmudev-ui .wpmudev-modal .wpmudev-modal-mask { background-color: "+t.overlay_bg+"; }";x.length&&x.remove(),T('<style id="hustle-module-mailchimp-custom-styles">'+C+"</style>").appendTo("body"),y.css("fill",t.close_button_static_color),b.mouseover(function(){y.css("fill",t.close_button_hover_color)}).mouseout(function(){y.css("fill",t.close_button_static_color)});var k=s.find(".hustle-modal-image img"),$="",S="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||($="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,S="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,k.css({"background-position":$+" "+S,"object-position":$+" "+S})),_.isTrue(t.border)){var O=t.border_weight+"px "+t.border_type+" "+t.border_color;n.css({border:O,"border-radius":t.border_radius+"px"})}if("right"===e.feature_image_location&&p.addClass("hustle-modal-image-right"),_.isTrue(t.drop_shadow)){var z=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;n.css({"box-shadow":z})}if(_.isTrue(t.form_fields_border)){var H=t.form_fields_border_weight+"px "+t.form_fields_border_type+" "+t.form_fields_border_color;m.css({border:H,"border-radius":t.form_fields_border_radius+"px"})}if(_.isTrue(t.button_border)){var M=t.button_border_weight+"px "+t.button_border_type+" "+t.button_border_color;g.css({border:M,"border-radius":t.button_border_radius+"px"})}},handle_email_service:function(i,e){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),e?(this.content_view.model.set("active_email_service",i),_.isEmpty(s)?s[i]={enabled:e}:_.each(s,function(e,t){t===i?s[t]=_.extend(s[t],{enabled:1}):(s[t]=_.extend(s[t],{enabled:0}),T('input[data-attribute="'+t+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[i]=_.extend(s[i],{enabled:e})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model.get("auto_close_success_message"),i=this.content_view.model.get("auto_close_time"),s=this.content_view.model.get("auto_close_unit"),o=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(t)){var n=parseInt(i);"minutes"===s&&(n*=60),n*=1e3,_.delay(function(){var e=o.find(".hustle-modal").find(".hustle-modal-close .hustle-icon");0<e.length?e.trigger("click"):$success_msg.removeAttr("style")},n)}}})}),Hustle.define("Embedded.Content_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-content-tpl"),module_id:0,target_container:i("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:i(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="embedded",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return void 0===t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"embedded"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-embedded-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"embedded",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=i(e.target);this.service_modal.add_service(t)},edit_email_service:function(e){e.preventDefault(),e.stopPropagation();var t=i(e.target);this.service_modal.edit_service(t)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Embedded.Design_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-design-tpl"),target_container:i("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(e,t){i(this).val(t.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(e){e.preventDefault();var t=i(e.target).data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(t),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Embedded.Listing",function(a){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .module-duplicate":"duplicate","click .import-module-settings":"import_settings","click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click #hustle-free-version-create":"show_upgrade_modal","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .hustle-delete-module":"delete_module","click .module-active-state":"toggle_module_activity","click .button-view-email-list":"view_email_list","click .button-view-log-list":"view_error_log_list","change .module-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this;this.$(".optin-type-active-state").each(function(){s.set_testmode_visibiliy(a(this),0)}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}});s=this;var e=a("#wpmudev-hustle-content .wpmudev-row"),o=e.length;e.each(function(){a(this).css("z-index",o),o--;var e=a(this).find(".wpmudev-dots-dropdown"),t=e.find(".wpmudev-dots-button"),i=e.find(".wpmudev-dots-nav");t.on("click",function(){a(this).toggleClass("wpmudev-active"),i.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(i).each(function(){a(this).hasClass("wpmudev-hide")||a(this).toggleClass("wpmudev-hide")})})}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},module_toggle_clicked:function(e){e.stopPropagation(),a(e.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(e){if(-1!==_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],e.target.className)){var t=a(e.target),i=t.parents(".wpmudev-row").find(".wpmudev-box-action"),s=t.parents(".wpmudev-row").find(".wpmudev-box-body");s.slideToggle("fast",function(){i.toggleClass("wpmudev-action-show"),s.toggleClass("wpmudev-hidden")})}},delete_module:function(e){var t=a(e.target).closest("a.hustle-delete-module"),i=t.data("id"),s=t.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=i,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(e){a(e.target).val()?a("#select_file_error").addClass("wpmudev-hidden"):a("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){void 0!==e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},toggle_module_activity:function(e){var t=this.$(e.target),i=t.data()||{},s=t.parents(".wpmudev-row");i.action="hustle_embedded_module_toggle_state",i._ajax_nonce=i.nonce,t.prop("disabled",!0),t.is(":checked")?(s.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),s.find("input").prop("disabled",!1)):(s.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),s.find("input").prop("disabled",!0)),a.post(ajaxurl,i,function(e){t.prop("disabled",!1)})},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=a(e.currentTarget).hasClass("wpmudev-button")?a(e.currentTarget):a(e.currentTarget).parents(".wpmudev-button"),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"embedded",module_fields:[]}})},set_testmode_visibiliy:function(e,t){void 0===t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(e){e.stopPropagation();var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type"),n=t.is(":checked");t.attr("disabled",!0),a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_embedded_module_toggle_tracking_activity",id:i,type:o,_ajax_nonce:s},complete:function(){t.attr("disabled",!1)},success:function(e){e.success||t.attr("checked",!n)},error:function(e){e.success||t.attr("checked",!n)}})},view_error_log_list:function(e){var t=a(e.currentTarget),i=t.data(),s=i.id,o=i.name,n=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new n({button:t,model:{name:o,id:s,type:"embedded",total:i.total}})},module_status_updated:function(e){var t=this.$(e.target),i=t.val(),s=t.data(),o=t.closest("li.wpmudev-tabs-menu_item");o.addClass("current"),o.siblings().removeClass("current"),s._ajax_nonce=s.nonce,"test"===i?s.action="hustle_embedded_toggle_test_activity":(s.action="hustle_embedded_module_toggle_type_state",s.enabled="off"===i?"false":"true"),a.post(ajaxurl,s,function(e){})},duplicate:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_embed_duplicate",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})}})}),Hustle.define("Embedded.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"embedded"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}});Hustle.get("Models.Trigger");return{Base:e,Content:t,Design:i,Display_Settings:Hustle.get("Models.M").extend({defaults:{after_content_enabled:!1,widget_enabled:!0,shortcode_enabled:!0,conditions:"",animation_in:"",animation_out:"",on_submit:"default"},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}})}}),Hustle.define("Embedded.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Embedded.View",function(H,e,t){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-embedded-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(e){return this.content_view=e.content_view,this.design_view=e.design_view,this.settings_view=e.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),H(document).off("click","ul.wpmudev-cta-target-options li",H.proxy(this.toggle_cta_options,this)),H(document).off("click","ul.wpmudev-after-submit-options li",H.proxy(this.toggle_submit_options,this)),H(document).off("click","ul.wpmudev-feature-image-position-options li",H.proxy(this.toggle_feature_image_position_options,this)),H(document).off("click","ul.wpmudev-feature-image-fit-options li",H.proxy(this.toggle_feature_image_fit_options,this)),H(document).off("click","ul.wpmudev-feature-image-horizontal-options li",H.proxy(this.toggle_feature_image_horizontal_options,this)),H(document).off("click","ul.wpmudev-feature-image-vertical-options li",H.proxy(this.toggle_feature_image_vertical_options,this)),H(document).off("click","ul.wpmudev-form-fields-icon-options li",H.proxy(this.toggle_form_fields_icon_options,this)),H(document).off("click","ul.wpmudev-form-fields-proximity-options li",H.proxy(this.toggle_form_fields_proximity_options,this)),H(document).off("click","ul.wpmudev-display-triggers li",H.proxy(this.toggle_display_triggers,this)),H(document).off("click",".wpmudev-preview",H.proxy(this.open_preview,this)),H(document).off("click",".hustle-modal-close .hustle-icon",H.proxy(this.close_preview,this)),H(document).off("click",".wpmudev-modal-mask",H.proxy(this.close_preview,this)),H(document).off("click",".wph-reset-color-palette",H.proxy(this.reset_color_palette,this)),H(document).off("keydown",H.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),H(document).on("click","ul.wpmudev-cta-target-options li",H.proxy(this.toggle_cta_options,this)),H(document).on("click","ul.wpmudev-after-submit-options li",H.proxy(this.toggle_submit_options,this)),H(document).on("click","ul.wpmudev-feature-image-position-options li",H.proxy(this.toggle_feature_image_position_options,this)),H(document).on("click","ul.wpmudev-feature-image-fit-options li",H.proxy(this.toggle_feature_image_fit_options,this)),H(document).on("click","ul.wpmudev-feature-image-horizontal-options li",H.proxy(this.toggle_feature_image_horizontal_options,this)),H(document).on("click","ul.wpmudev-feature-image-vertical-options li",H.proxy(this.toggle_feature_image_vertical_options,this)),H(document).on("click","ul.wpmudev-form-fields-icon-options li",H.proxy(this.toggle_form_fields_icon_options,this)),H(document).on("click","ul.wpmudev-form-fields-proximity-options li",H.proxy(this.toggle_form_fields_proximity_options,this)),H(document).on("click","ul.wpmudev-display-triggers li",H.proxy(this.toggle_display_triggers,this)),H(document).on("click",".wpmudev-preview",H.proxy(this.open_preview,this)),H(document).on("click",".hustle-modal-close .hustle-icon",H.proxy(this.close_preview,this)),H(document).on("click",".wpmudev-modal-mask",H.proxy(this.close_preview,this)),H(document).on("click",".wph-reset-color-palette",H.proxy(this.reset_color_palette,this)),H(document).on("change keyup keypress","input[name=module_name]",H.proxy(this.validate_modal_name,this)),H(document).on("keydown",H.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",H.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var e=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");e.length&&e.remove();var i=this,t=i.content_view.model.get("main_content"),s=H(".wpmudev-preview").data("nonce");-1===t.search(/\[/g)?i.render_preview(i.content_view.model.toJSON()):H.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:t,_ajax_nonce:s},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});o.unique_id="",t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var e=this,t=this.$("#wph-preview-modal").addClass("wpmudev-modal-active").find(".hustle-modal"),i=this.settings_view.model.get("animation_in");H("body").addClass("wpmudev-modal-is_active"),t.hasClass("hustle-animated")?setTimeout(function(){t.addClass("hustle-animate-"+i),e.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style;if(_.isTrue(e.use_email_collection))this.apply_preview_optin_styles();else{var s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-body section"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find(".hustle-modal-image"),c=o.find("article, .hustle-modal-message"),u=o.find("article blockquote, .hustle-modal-message blockquote"),p=o.find("article a, .hustle-modal-message a"),m=o.find(".hustle-modal-cta"),h=o.find(".hustle-modal-close"),v=o.find(".hustle-modal-close svg path"),g=s.find(".wpmudev-modal-mask");"cabriolet"===i?a.css("background-color",t.main_bg_color):n.css("background-color",t.main_bg_color),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("background-color",t.image_container_bg),c.css("color",t.content_color),u.css("border-left-color",t.link_static_color),u.mouseover(function(){H(this).css("border-left-color",t.link_hover_color)}).mouseout(function(){H(this).css("border-left-color",t.link_static_color)}),p.css("color",t.link_static_color),p.mouseover(function(){H(this).css("color",t.link_hover_color)}).mouseout(function(){H(this).css("color",t.link_static_color)}),m.css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color}),m.mouseover(function(){H(this).css({"background-color":t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){H(this).css({"background-color":t.cta_button_static_bg,color:t.cta_button_static_color})}),v.css("fill",t.close_button_static_color),h.mouseover(function(){v.css("fill",t.close_button_hover_color)}).mouseout(function(){v.css("fill",t.close_button_static_color)}),g.css("background-color",t.overlay_bg);var f=s.find(".hustle-modal-image img"),w="",b="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||(w="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,b="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,f.css({"background-position":w+" "+b,"object-position":w+" "+b})),_.isTrue(t.border)){var y=t.border_weight+"px "+t.border_type+" "+t.border_color;"cabriolet"===i?o.find("section").css({border:y,"border-radius":t.border_radius+"px"}):n.css({border:y,"border-radius":t.border_radius+"px"})}if(_.isTrue(t.drop_shadow)){var x=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;"cabriolet"===i?o.find("section").css({"box-shadow":x}):n.css({"box-shadow":x})}}},apply_preview_optin_styles:function(){this.content_view.model.toJSON();var e=this.design_view.model.toJSON(),t=e.form_layout,i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=s.find(".hustle-modal-body"),n=s.find(".hustle-modal-success"),a=s.find(".hustle-modal-title"),l=s.find(".hustle-modal-subtitle"),d=s.find("article"),r=s.find("article blockquote"),c=s.find("article a:not(.hustle-modal-cta)"),u=s.find(".hustle-modal-optin_field"),p=u.find("label .hustle-modal-optin_icon .hustle-icon path"),m=u.find("label .hustle-modal-optin_placeholder"),h=s.find(".hustle-modal-optin_button button"),v=s.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),g=s.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),f=s.find(".hustle-modal-close"),w=s.find(".hustle-modal-close svg path");o.css("background-color",e.main_bg_color),n.css("background-color",e.main_bg_color),o.find(".hustle-modal-image").css("background-color",e.image_container_bg),"one"===t||"two"===t?s.find("footer").css("background-color",e.form_area_bg):s.find(".hustle-modal-optin_wrap").css("background-color",e.form_area_bg),a.css("color",e.title_color),l.css("color",e.subtitle_color),d.css("color",e.content_color),r.css("border-left-color",e.link_static_color),c.css("color",e.link_static_color),c.mouseover(function(){H(this).css("color",e.link_hover_color)}).mouseout(function(){H(this).css("color",e.link_static_color)}),d.find(".hustle-modal-cta").css({background:e.cta_button_static_bg,color:e.cta_button_static_color}),d.find(".hustle-modal-cta").mouseover(function(){H(this).css({background:e.cta_button_hover_bg,color:e.cta_button_hover_color})}).mouseout(function(){H(this).css({background:e.cta_button_static_bg,color:e.cta_button_static_color})}),u.find("input").css("color",e.optin_form_field_text_static_color),u.css("background-color",e.optin_input_static_bg),u.mouseover(function(){H(this).find("input").css("color",e.optin_form_field_text_hover_color),H(this).css("background-color",e.optin_input_hover_bg)}).mouseout(function(){H(this).find("input").css("color",e.optin_form_field_text_static_color),H(this).css("background-color",e.optin_input_static_bg)}),p.css("fill",e.optin_input_icon),h.css("color",e.optin_submit_button_static_color),h.css("background-color",e.optin_submit_button_static_bg),h.mouseover(function(){H(this).css("color",e.optin_submit_button_hover_color),H(this).css("background-color",e.optin_submit_button_hover_bg)}).mouseout(function(){H(this).css("color",e.optin_submit_button_static_color),H(this).css("background-color",e.optin_submit_button_static_bg)}),m.css("color",e.optin_placeholder_color),v.css("background-color",e.optin_check_radio_static_bg),g.css("background-color",e.optin_check_radio_static_bg);var b=H("#hustle-module-checkbox-radio-custom-styles"),y=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before { color: "+e.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before { color: "+e.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before { color: "+e.optin_check_radio_static_bg+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before { color: "+e.optin_check_radio_tick_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label { color: "+e.optin_mailchimp_title_color+"; }.hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label { color: "+e.optin_mailchimp_labels_color+"; }.wpmudev-ui .wpmudev-modal .wpmudev-modal-mask { background-color: "+e.overlay_bg+"; }";b.length&&b.remove(),H('<style id="hustle-module-mailchimp-custom-styles">'+y+"</style>").appendTo("body"),w.css("fill",e.close_button_static_color),f.mouseover(function(){w.css("fill",e.close_button_hover_color)}).mouseout(function(){w.css("fill",e.close_button_static_color)});var x=i.find(".hustle-modal-image img"),C="",k="";if("contain"!==e.feature_image_fit&&"cover"!==e.feature_image_fit||(C="custom"===e.feature_image_horizontal?e.feature_image_horizontal_px+"px":e.feature_image_horizontal,k="custom"===e.feature_image_vertical?e.feature_image_vertical_px+"px":e.feature_image_vertical,x.css({"background-position":C+" "+k,"object-position":C+" "+k})),_.isTrue(e.border)){var $=e.border_weight+"px "+e.border_type+" "+e.border_color;o.css({border:$,"border-radius":e.border_radius+"px"})}if(_.isTrue(e.drop_shadow)){var S=e.drop_shadow_x+"px "+e.drop_shadow_y+"px "+e.drop_shadow_blur+"px "+e.drop_shadow_spread+"px "+e.drop_shadow_color;o.css({"box-shadow":S})}if(_.isTrue(e.form_fields_border)){var O=e.form_fields_border_weight+"px "+e.form_fields_border_type+" "+e.form_fields_border_color;u.css({border:O,"border-radius":e.form_fields_border_radius+"px"})}if(_.isTrue(e.button_border)){var z=e.button_border_weight+"px "+e.button_border_type+" "+e.button_border_color;h.css({border:z,"border-radius":e.button_border_radius+"px"})}},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal").find(".hustle-modal"),n=o.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(o.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var a=o.find(".hustle-modal-close").height()+15,l=o.find(".hustle-modal-content");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),l.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var d=o.find("section"),r=o.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)c=0;else var c=o.find("header").outerHeight();if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var u=o.find("footer").innerHeight();else u=0;d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+a+"px - "+c+"px - "+u+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){c=o.find("header").height()+20,d=o.find("section"),r=o.find(".hustle-modal-message");d.css({height:"calc("+t.custom_height+"px - "+c+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+c+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var p=o.find(".hustle-modal-image"),m=(d=o.find("section"),o.find("article"));if(d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),d.hasClass("hustle-modal-image_above")||d.hasClass("hustle-modal-image_below")){t.custom_height;d.height()<250?d.css({"overflow-y":"auto"}):m.css({height:"calc("+d.height()+"px - "+p.height()+"px)","overflow-y":"auto"})}else m.css({"max-height":"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"}),p.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,u=o.find("footer").height();var h=o.find(".hustle-modal-body");d=o.find("section"),m=o.find("article");h.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+u+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15;var v=o.find(".hustle-modal-image").height();m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){a=o.find(".hustle-modal-close").height()+15,v=o.find(".hustle-modal-image").height();var g=t.custom_height-a-v,f=o.find(".hustle-modal-optin_wrap");m=o.find("article");n.css({height:"calc("+t.custom_height+"px - "+a+"px)"}),m.css({height:"calc("+t.custom_height+"px - "+a+"px)","overflow-y":"auto"}),f.css({height:"calc("+t.custom_height+"px - "+a+"px - "+v+"px)","overflow-y":"auto"}),o.find(".hustle-modal-optin_form").innerHeight()>g&&f.css({"align-items":"flex-start"})}}},apply_custom_css:function(){H("#hustle-module-custom-styles").remove();var e=this.design_view.model.toJSON().customize_css;if(1===e||"1"===e){var t=this.design_view.model.get("custom_css"),i=H("#hustle_custom_css").data("nonce");if(_.isEmpty(t)||void 0===i)return;H.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_embedded_prepare_custom_css",css:t,_ajax_nonce:i},success:function(e){if(e&&e.success){var t=H("#hustle-module-custom-styles");t.length&&t.remove(),H('<style id="hustle-module-custom-styles">'+e.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(e){e.stopPropagation();var t=this.$("#wph-preview-modal"),i=t.find(".hustle-modal"),s="hustle-animate-"+this.settings_view.model.get("animation_in"),o=this.settings_view.model.get("animation_out"),n="hustle-animate-"+o,a=1e3;i.removeClass(s).addClass(n),i.hasClass("hustle-animated")&&("fadeOut"===o&&(a=305),"newspaperOut"===o&&(a=505),"bounceOut"===o&&(a=755),setTimeout(function(){t.removeClass("wpmudev-modal-active"),H("body").removeClass("wpmudev-modal-is_active"),i.removeClass(n)},a)),i.hasClass("hustle-modal-static")&&(i.removeClass("hustle-modal-static"),t.removeClass("wpmudev-modal-active"),H("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},provider_add_custom_fields:function(e,t,i,s){var o=s.content_view.model.get("active_email_service");if(!0===Module.Utils.service_supports_fields(0,o)&&("form_elements"in i||"email_services"in i||"active_email_service"in i)&&"object"==typeof s.content_view.model.get("form_elements")){var n={action:"add_module_fields",_ajax_nonce:t,data:JSON.stringify(s.content_view.model.get("form_elements")),provider:o,module_id:e};H.post(ajaxurl,n,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(e){if(!Module.Validate.validate_module_name())return!1;var t=this.content_view.model.changed;this.set_content_from_tinymce(!0),this.sanitize_data();var i=this,s=e.data("id")?e.data("id"):"-1",o=e.data("nonce"),n=this.model.toJSON(),a=this.content_view.model.toJSON(),l=this.design_view.model.toJSON(),d=this.settings_view.model.toJSON();return H.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_embedded_module",_ajax_nonce:o,id:s,module:n,content:a,design:l,settings:d,shortcode_id:i._get_shortcode_id()},complete:function(e){i.provider_add_custom_fields(s,o,t,i);e.responseJSON}})},show_error:function(e){return H("<label><span>"+e.data+"</span></label>").prop({class:"wpmudev-label--notice",id:"wpmudev-hustle-error-message"}).insertAfter(H(".wpmudev-box-footer")),H("#wpmudev-hustle-error-message").delay(5e3).fadeOut("slow",function(){H(this).remove()}),this},remove_loading_icon:function(e){return e.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1),this},save_changes:function(e){e.preventDefault();var s=this,o=H(e.currentTarget);s.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(o),n=this;t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=window.location.pathname+window.location.search;if(-1===t.indexOf("&id=")&&(t=t+"&id="+e.data,window.history.replaceState({},"",t),s.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){H(this).attr("href",H(this).data("link")+"&id="+e.data)})),o.data("id",e.data),o.siblings().data("id",e.data),Module.hasChanges=!1,"settings"===(optin_vars.current.section||!1)){var i=e.data;return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+i)}}else n.show_error(e)}).always(function(){n.remove_loading_icon(s)}):this.remove_loading_icon(s)},save_continue:function(e){e.preventDefault();var o=this;o.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(H(e.currentTarget)),n=this;t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,i=optin_vars.current.section||!1,s="";return window.onbeforeunload=null,i&&"content"!==i?"design"===i&&(s=o.$(".wpmudev-menu-settings-link a").data("link")):s=o.$(".wpmudev-menu-design-link a").data("link"),-1===s.indexOf("&id")&&(s+="&id="+t),window.location.replace(s)}n.show_error(e).remove_loading_icon(o)}):this.remove_loading_icon(o)},save_finish:function(e){e.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var t=this.save(H(e.currentTarget)),s=this;t?t.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}s.show_error(e).remove_loading_icon(i)}):this.remove_loading_icon(i)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();this.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var t=optin_vars.current.section;window.onbeforeunload=null,"design"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===t&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t,i=e.changed,s=Object.keys(i);"has_title"in i&&((t=this.$("#wph-wizard-content-title-textboxes")).length&&(i.has_title?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"use_feature_image"in i&&((t=this.$("#wph-wizard-content-image-options")).length&&(i.use_feature_image?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_cta"in i&&((t=this.$("#wph-wizard-content-cta-options")).length&&(i.show_cta?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));"show_gdpr"in i&&((t=this.$("#wph-wizard-content-gdpr-message")).length&&(i.show_gdpr?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")));("use_email_collection"in i&&this.use_email_collection_changed(i.use_email_collection),"after_successful_submission"in i&&this.after_successful_submission_changed(i.after_successful_submission),"auto_close_success_message"in i)&&((t=this.$("#wph-wizard-content-form_success_options")).length&&(i.auto_close_success_message?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));"save_local_list"in i&&((t=this.$("#wph-wizard-content-local_list_name")).length&&(i.save_local_list?(t.addClass("wpmudev-show"),t.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),t.removeClass("wpmudev-show"))));if(-1!==s[0].indexOf("_service_provider")){var o=s[0].replace("_service_provider","");this.handle_email_service(o,i[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}"feature_image_fit"in t&&((s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options")).length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_horizontal"in t&&((s=this.$("#wph-wizard-design-horizontal-position")).length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"feature_image_vertical"in t&&((s=this.$("#wph-wizard-design-vertical-position")).length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"border"in t&&((s=this.$("#wph-wizard-design-border-options")).length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"form_fields_border"in t&&((s=this.$("#wph-wizard-design-form-fields-border-options")).length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"button_border"in t&&((s=this.$("#wph-wizard-design-button-border-options")).length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"drop_shadow"in t&&((s=this.$("#wph-wizard-design-shadow-options")).length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_size"in t&&((s=this.$("#wph-wizard-design-size-options")).length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))));"customize_css"in t&&((s=this.$("#wph-wizard-design-css_holder")).length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden"))))},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}"on_time_delay"in t&&this.settings_view.model.set("triggers.on_time_delay",t.on_time_delay,{silent:!0}),"on_time_unit"in t&&this.settings_view.model.set("triggers.on_time_unit",t.on_time_unit,{silent:!0}),"on_exit_intent"in t&&this.settings_view.model.set("triggers.on_exit_intent",t.on_exit_intent,{silent:!0}),"on_exit_intent_per_session"in t&&this.settings_view.model.set("triggers.on_exit_intent_per_session",t.on_exit_intent_per_session,{silent:!0}),"on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0})},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var i=this;if(parseInt(this.content_view.model.get("use_email_collection"))){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var i=this,e=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_");if(parseInt(this.content_view.model.get("use_email_collection"),10)){var t=this.$('option[value="'+e+'"]').text();if(void 0!==optin_vars.palettes[t]){var s=optin_vars.palettes[t];_.each(s,function(e,t){i.$('input[data-attribute="'+t+'"]').val(e).trigger("change")})}}},use_email_collection_changed:function(e){var t=this.$("#wph-wizard-content-email"),i=this.$("#wph-wizard-content-email-options"),s=this.$("#wph-wizard-content-form_elements"),o=this.$("#wph-wizard-content-form_submission"),n=this.$("#wph-wizard-content-form_message"),a=this.$("#wph-wizard-content-form_success");parseInt(e)?(t.removeClass("last"),i.removeClass("wpmudev-hidden_table"),i.addClass("wpmudev-show_table"),s.show(),o.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.model.set("style","gray_slate")):(t.hasClass("last")||t.addClass("last"),i.removeClass("wpmudev-show_table"),i.addClass("wpmudev-hidden_table"),s.hide(),o.hide(),n.hide(),a.hide(),this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("cta_target",i.val(),{silent:!0})},toggle_submit_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",i.val())},toggle_feature_image_position_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",i.val(),{silent:!0})},toggle_feature_image_fit_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",i.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",i.val(),{silent:!1})},toggle_feature_image_vertical_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",i.val(),{silent:!1})},toggle_form_fields_icon_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",i.val(),{silent:!1})},toggle_form_fields_proximity_options:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",i.val(),{silent:!1})},toggle_display_triggers:function(e){var t=H(e.target).closest("li"),i=t.find("input");t.hasClass("current")||t.addClass("current"),t.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",i.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(i,e){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),e?(this.content_view.model.set("active_email_service",i),_.isEmpty(s)?s[i]={enabled:e}:_.each(s,function(e,t){t===i?s[t]=_.extend(s[t],{enabled:1}):(s[t]=_.extend(s[t],{enabled:0}),H('input[data-attribute="'+t+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[i]=_.extend(s[i],{enabled:e})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model.get("auto_close_success_message"),i=this.content_view.model.get("auto_close_time"),s=this.content_view.model.get("auto_close_unit"),o=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(t)){var n=parseInt(i);"minutes"===s&&(n*=60),n*=1e3,_.delay(function(){var e=o.find(".hustle-modal").find(".hustle-modal-close .hustle-icon");0<e.length?e.trigger("click"):$success_msg.removeAttr("style")},n)}}})}),Hustle.define("SShare.Content_View",function(a,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-services-tpl"),target_container:a("#wpmudev-hustle-box-section-services"),init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.render()},events:{"click ul.wpmudev-tabs-menu li label":"toggle_checkbox","change .wpmudev-social-item input.wpmudev-social-item-native-enable":"toggle_icon","change .wpmudev-social-custom .wpmudev-social-item input.toggle-checkbox":"toggle_icon"},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},t))),this}},after_render:function(){this.target_container.length},model_updated:function(e){var t=e.changed;"service_type"in t&&this.service_type_updated(t.service_type),"click_counter"in t&&this.click_counter_updated(t.click_counter)},service_type_updated:function(e){var t=this.$("#wpmudev-sshare-counter-options"),i=a(".wph-wizard-services-icons-native"),s=a(".wph-wizard-services-icons-custom");"native"===e?(t.removeClass("wpmudev-hidden"),s.addClass("wpmudev-hidden"),i.removeClass("wpmudev-hidden")):(t.addClass("wpmudev-hidden"),i.addClass("wpmudev-hidden"),s.removeClass("wpmudev-hidden"))},click_counter_updated:function(i){var e=a("#wpmudev-sshare-counter-options .hustle-twitter-notice");"native"===i?e.removeClass("wpmudev-hidden"):e.hasClass("wpmudev-hidden")||e.addClass("wpmudev-hidden"),a("#wph-wizard-services-icons-native .wpmudev-social-item").each(function(){var e=a(this).find(".toggle-checkbox").is(":checked"),t=a(this).find("input.wpmudev-input_number");"none"!==i&&e?t.removeClass("wpmudev-hidden"):t.hasClass("wpmudev-hidden")||t.addClass("wpmudev-hidden")}),a("#wph-wizard-services-icons-native #wpmudev-counter-title>strong").removeClass("wpmudev-hidden"),"none"===i?a("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:first-child").addClass("wpmudev-hidden"):a("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:nth-child(2)").addClass("wpmudev-hidden")},toggle_checkbox:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target).closest("li"),i=t.find("input"),s=i.data("attribute");t.hasClass("current")||(t.addClass("current"),t.siblings().removeClass("current"),this.model.set(s,i.val()))},toggle_icon:function(e){var t=this.$(e.target),i=t.is(":checked"),s="none"!==this.model.get("click_counter"),o=t.closest(".wpmudev-social-item"),n=o.find("input.wpmudev-input_number"),a=!(!i||!s);i?o.removeClass("disabled"):o.addClass("disabled"),0<t.parents(".wpmudev-social-native").length&&(a?n.removeClass("wpmudev-hidden"):n.addClass("wpmudev-hidden"))},set_social_icons:function(){var e=this.model.toJSON();e=this.get_social_icons_data(e),this.model.set("social_icons",e.social_icons,{silent:!0})},get_social_icons_data:function(e){var t=a("#wph-wizard-services-icons-"+e.service_type+" .wpmudev-social-item"),n={};return t.each(function(){var e=a(this),t=e.find("input.toggle-checkbox"),i=t.data("id"),s=e.find("input.wpmudev-input_number"),o=e.find("input.wpmudev-input_text");s.length&&(parseInt(s.val())<0&&s.val(0));t.is(":checked")&&(n[i]={enabled:!0,counter:s.length?s.val():"0",link:o.length?o.val():""})}),t.length&&(e.social_icons=n),e}}))}),Hustle.define("SShare.Design_View",function(m,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-design-tpl"),target_container:m("#wpmudev-hustle-box-section-design"),social_icons:{},service_type:"native",click_counter:"click",excluded_rerender:["floating_social_bg","floating_counter_color","floating_counter_border","icon_bg_color","icon_color","drop_shadow_x","drop_shadow_y","drop_shadow_blur","drop_shadow_spread","drop_shadow_color","widget_icon_bg_color","widget_icon_color","widget_bg_color","widget_drop_shadow_x","widget_drop_shadow_y","widget_drop_shadow_blur","widget_drop_shadow_spread","widget_drop_shadow_color","widget_counter_border","widget_counter_color"],init:function(e){return this.on("rendered",this.create_color_pickers),this.social_icons=e.social_icons,this.service_type=e.service_type,this.click_counter=e.click_counter,this.render_design()},render_design:function(e){if(this.target_container.length){var t=this.model.toJSON();return this._handle_icons_order(),this.setElement(this.template(_.extend({module_type:"social_sharing",social_icons:this.social_icons,service_type:this.service_type,click_counter:this.click_counter},t))),this}},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.make_icons_sortable(),this._handle_preview())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(e,t){m(this).val(t.color.toCSS()).trigger("change")}})},make_icons_sortable:function(){var i=this,e={items:".hustle-social-icon",revert:!0,axis:"x",containment:this.$("#wpmudev-reoder-icons"),stop:function(e,t){i._reorder_icons()}};this.$("#wph-reorder-icons").sortable(e).disableSelection()},model_updated:function(e){this._handle_preview()},_handle_preview:function(){var e=m("#wph-sshare-preview-floating .hustle-shares-floating"),t=e.find(".hustle-shares-counter"),i=e.find(".hustle-icon-container"),s=e.find(".hustle-icon-path"),o=e.find(".hustle-social-icon"),n=m("#wph-sshare-preview-widget .hustle-shares-widget"),a=n.find(".hustle-shares-counter"),l=n.find(".hustle-icon-container"),d=n.find(".hustle-icon-path"),r=n.find(".hustle-social-icon"),c=this.model.toJSON();if(e.css("background-color",c.floating_social_bg),t.css("color",c.floating_counter_color),_.isTrue(c.customize_colors)&&("rounded"===c.icon_style||"squared"===c.icon_style?i.css("background-color",c.icon_bg_color):"outline"===c.icon_style&&o.css("border-color",c.icon_bg_color),s.css("fill",c.icon_color),"native"===this.service_type&&"none"!==this.click_counter&&o.css("border-color",c.floating_counter_border)),_.isTrue(c.drop_shadow)){var u=c.drop_shadow_x+"px "+c.drop_shadow_y+"px "+c.drop_shadow_blur+"px "+c.drop_shadow_spread+"px "+c.drop_shadow_color;e.css("box-shadow",u)}if(n.css("background-color",c.widget_bg_color),a.css("color",c.widget_counter_color),_.isTrue(c.customize_widget_colors)&&("rounded"===c.icon_style||"squared"===c.icon_style?l.css("background-color",c.widget_icon_bg_color):"outline"===c.icon_style&&r.css("border-color",c.widget_icon_bg_color),d.css("fill",c.widget_icon_color),"native"===this.service_type&&"none"!==this.click_counter&&r.css("border-color",c.widget_counter_border)),_.isTrue(c.widget_drop_shadow)){var p=c.widget_drop_shadow_x+"px "+c.widget_drop_shadow_y+"px "+c.widget_drop_shadow_blur+"px "+c.widget_drop_shadow_spread+"px "+c.widget_drop_shadow_color;n.css("box-shadow",p)}},_handle_icons_order:function(){var t={},s=this.social_icons,e=this.model.get("icons_order"),i=e.split(",");e&&i.length&&(_.each(i,function(i,e){void 0!==s[i]&&(t[i]=s[i],s=_.pick(s,function(e,t){if(i!==t)return e}))}),Object.keys(s).length&&(t=_.extend(t,_.pick(s,function(e,t){if(void 0!==e)return e}))),this.social_icons=t)},_reorder_icons:function(){var e=[];m("#wph-reorder-icons .hustle-social-icon").each(function(){e.push(m(this).data("id"))}),this.model.set("icons_order",e.join())}}))}),Hustle.define("SShare.Listing",function(a,e,t){"use strict";var i=Hustle.get("Delete_Confirmation"),n=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",events:{"click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click #hustle-free-version-create":"show_upgrade_modal","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .social-sharing-edit":"edit","click .hustle-delete-module":"delete_module","change .social-sharing-toggle-activity":"toggle_module_activity","change .social-sharing-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated","click .module-duplicate":"duplicate","click .import-module-settings":"import_settings","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},delete_confirmations:{},initialize:function(){this.delete_confirmation=new i({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}});var s=this,e=a("#wpmudev-hustle-content .wpmudev-row"),o=e.length;e.each(function(){a(this).css("z-index",o),o--;var e=a(this).find(".wpmudev-dots-dropdown"),t=e.find(".wpmudev-dots-button"),i=e.find(".wpmudev-dots-nav");t.on("click",function(){a(this).toggleClass("wpmudev-active"),i.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(i).each(function(){a(this).hasClass("wpmudev-hide")||a(this).toggleClass("wpmudev-hide")})})}),this.upgrade_modal=new n,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},module_toggle_clicked:function(e){e.stopPropagation(),a(e.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(e){if(-1!==_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],e.target.className)){var t=a(e.target),i=t.parents(".wpmudev-row").find(".wpmudev-box-action"),s=t.parents(".wpmudev-row").find(".wpmudev-box-body");s.slideToggle("fast",function(){i.toggleClass("wpmudev-action-show"),s.toggleClass("wpmudev-hidden")})}},toggle_module_activity:function(e){e.stopPropagation();var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.is(":checked"),n=t.parents(".wpmudev-row");t.prop("disabled",!0),o?(n.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),n.find("input").prop("disabled",!1)):(n.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),n.find("input").prop("disabled",!0)),a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_module_toggle_state",id:i,_ajax_nonce:s},complete:function(){t.prop("disabled",!1)},success:function(e){e.success||t.attr("checked",!o)},error:function(){t.attr("checked",!o)}})},toggle_tracking_activity:function(e){e.stopPropagation();var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type"),n=t.is(":checked");t.attr("disabled",!0),a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_toggle_tracking_activity",id:i,type:o,_ajax_nonce:s},complete:function(){t.attr("disabled",!1)},success:function(e){e.success||t.attr("checked",!n)},error:function(e){e.success||t.attr("checked",!n)}})},toggle_type_activity:function(e){e.stopPropagation();var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type"),n=t.is(":checked");t.attr("disabled",!0),a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_type_activity",id:i,type:o,_ajax_nonce:s},complete:function(){t.attr("disabled",!1)},success:function(e){e.success||t.attr("checked",!n)},error:function(e){e.success||t.attr("checked",!n)}})},edit:function(e){e.stopPropagation()},delete_module:function(e){var t=a(e.target).closest("a.hustle-delete-module"),i=t.data("id"),s=t.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=i,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(e){a(e.target).val()?a("#select_file_error").addClass("wpmudev-hidden"):a("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){void 0!==e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},module_status_updated:function(e){var t=this.$(e.target),i=t.val(),s=t.data(),o=t.closest("li.wpmudev-tabs-menu_item");o.addClass("current"),o.siblings().removeClass("current"),s._ajax_nonce=s.nonce,"test"===i?s.action="hustle_sshare_toggle_test_activity":(s.action="hustle_sshare_module_toggle_type_state",s.enabled="off"===i?"false":"true"),a.post(ajaxurl,s,function(e){})},duplicate:function(e){var t=a(e.target),i=t.data("id"),s=t.data("nonce"),o=t.data("type");a.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_share_duplicate",id:i,type:o,_ajax_nonce:s},complete:function(){location.reload()}})}})}),Hustle.define("SShare.Models",function(){"use strict";return{Base:Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"social_sharing"})}),Content:Hustle.get("Models.M").extend({defaults:{module_name:"",active:0,test_mode:0,service_type:"native",click_counter:"click",social_icons:""}}),Design:Hustle.get("Models.M").extend({defaults:{icon_style:"squared",icons_order:"",customize_colors:0,icon_bg_color:"rgba(146, 158, 170, 1)",icon_color:"rgba(255, 255, 255, 1)",floating_social_bg:"rgba(4, 48, 69, 1)",floating_counter_border:"rgba(146, 158, 170, 1)",floating_counter_color:"rgba(255, 255, 255, 1)",floating_social_animate_icons:0,drop_shadow:0,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",floating_inline_count:0,customize_widget_colors:0,widget_icon_bg_color:"rgba(146, 158, 170, 1)",widget_icon_color:"rgba(255, 255, 255, 1)",widget_bg_color:"rgba(146, 158, 170, 1)",widget_animate_icons:0,widget_drop_shadow:0,widget_drop_shadow_x:0,widget_drop_shadow_y:0,widget_drop_shadow_blur:0,widget_drop_shadow_spread:0,widget_drop_shadow_color:"rgba(0,0,0,0)",widget_inline_count:0,widget_counter_border:"rgba(146, 158, 170, 1)",widget_counter_color:"rgba(255, 255, 255, 1)"}}),Display_Settings:Hustle.get("Models.M").extend({defaults:{floating_social_enabled:!0,widget_enabled:!0,shortcode_enabled:!0,conditions:"",location_type:"screen",location_target:"",location_align_x:"left",location_align_y:"top",location_top:0,location_bottom:0,location_right:0,location_left:0},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}),Types:Hustle.get("Models.M").extend({defaults:{widget:"",shortcode:""}})}}),Hustle.define("SShare.Settings_View",function(i,e,t){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpmudev-hustle-sshare-section-settings-tpl"),target_container:i("#wpmudev-hustle-box-section-settings"),message_editor:!1,events:{"click .wpmudev-copy button":"copy_shortcode"},init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){if(this.target_container.length){var e=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},e))),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),this}},after_render:function(){this.target_container.length},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-floating-social-condition-labels").toggle()},update_conditions_label:function(e){i("#wph-floating-social-condition-labels").html(e.get_all_conditions_labels())},model_updated:function(e){var t=e.changed;if(console.log(t),"location_type"in t){var i=this.$("#wpmudev-sshare-selector-location-options");"selector"===t.location_type?i.removeClass("wpmudev-hidden"):i.addClass("wpmudev-hidden")}if("location_align_x"in t){var s=this.$("#wpmudev-floating-horizontal-left"),o=this.$("#wpmudev-floating-horizontal-right");"left"===t.location_align_x?(s.addClass("current"),o.removeClass("current")):(s.removeClass("current"),o.addClass("current"))}if("location_align_y"in t){var n=this.$("#wpmudev-floating-vertical-top"),a=this.$("#wpmudev-floating-vertical-bottom");"top"===t.location_align_y?(n.addClass("current"),a.removeClass("current")):(n.removeClass("current"),a.addClass("current"))}},copy_shortcode:function(e){var t=i(e.target).siblings("input");t.prop("disabled",!1).select(),document.execCommand("copy"),t.prop("disabled",!0)}}))}),Hustle.define("SShare.View",function(n,e,t){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-sshare-wizard-view",message_box_tpl:Optin.template("wpoi-social-sharing-message-box-tpl"),preview:!1,preview_model:!1,initial_data:new Backbone.Model({content:""}),events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(e){return this.content_view=e.content_view,this.design_view=e.design_view,this.settings_view=e.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.design_view.model,"change",this.design_view_changed),n(document).on("change keyup keypress","input[name=module_name]",n.proxy(this.validate_modal_name,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render(),this.render_design_view(),this.settings_view.target_container.html(""),this.settings_view.render(),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},render_design_view:function(){this.design_view.target_container.html(""),this.design_view.render_design(),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render()},design_view_changed:function(e){var t=Object.keys(e.changed)[0];-1!==this.design_view.excluded_rerender.indexOf(t)?this.design_view.model_updated(e.changed):this.render_design_view()},sanitize_data:function(){_.isEmpty(this.model.get("module_name"))&&this.model.set("module_name",this.content_view.model.get("module_name"))},save:function(e){if(!Module.Validate.validate_module_name())return!1;this.sanitize_data();var t=this.model.toJSON(),i=this.content_view.model.toJSON(),s=this.design_view.model.toJSON(),o=this.settings_view.model.toJSON();return i=this.content_view.get_social_icons_data(i),n.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_sshare_module",_ajax_nonce:e.data("nonce"),id:e.data("id")?e.data("id"):"-1",module:t,content:i,design:s,settings:o,shortcode_id:this._get_shortcode_id()},complete:function(e){e.responseJSON}})},save_changes:function(e){e.preventDefault();var s=this,o=n(e.currentTarget);s.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(o);t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=window.location.pathname+window.location.search;if(-1===t.indexOf("&id=")&&(t=t+"&id="+e.data,window.history.replaceState({},"",t),s.$(".wpmudev-menu-services-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){n(this).attr("href",n(this).data("link")+"&id="+e.data)})),o.data("id",e.data),o.siblings().data("id",e.data),Module.hasChanges=!1,"settings"===(optin_vars.current.section||!1)){var i=e.data;return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+i)}}}).always(function(){s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):s.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(e){e.preventDefault();var o=this;o.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var t=this.save(n(e.currentTarget));t?t.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,i=optin_vars.current.section||!1,s="";return window.onbeforeunload=null,i&&"services"!==i?"design"===i&&(s=o.$(".wpmudev-menu-settings-link a").data("link")):s=o.$(".wpmudev-menu-design-link a").data("link"),-1===s.indexOf("&id")&&(s+="&id="+t),window.location.replace(s)}}):o.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(e){e.preventDefault();this.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var t=this.save(n(e.currentTarget));t?t.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):this.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();this.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var t=optin_vars.current.section;window.onbeforeunload=null,"design"===t?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"settings"===t&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"services"===t?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")}})}),Hustle.define("Popup.Module",function(){"use strict";!function(){if("hustle_page_hustle_popup_listing"===pagenow)new(Hustle.get("Popup.Listing"))}(),function(){if("hustle_page_hustle_popup"===pagenow){var e=Hustle.get("Pop_Up.View"),t=Hustle.get("Pop_Up.Content_View"),i=Hustle.get("Pop_Up.Design_View"),s=Hustle.get("Pop_Up.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Pop_Up.Models.Base"),a=Hustle.get("Pop_Up.Models.Content"),l=Hustle.get("Pop_Up.Models.Design"),d=Hustle.get("Pop_Up.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"pop-up"})})})}}()}),Hustle.define("Slidein.Module",function(){"use strict";!function(){if("hustle_page_hustle_slidein_listing"===pagenow)new(Hustle.get("Slidein.Listing"))}(),function(){if("hustle_page_hustle_slidein"===pagenow){var e=Hustle.get("Slidein.View"),t=Hustle.get("Slidein.Content_View"),i=Hustle.get("Slidein.Design_View"),s=Hustle.get("Slidein.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Slidein.Models.Base"),a=Hustle.get("Slidein.Models.Content"),l=Hustle.get("Slidein.Models.Design"),d=Hustle.get("Slidein.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"slidein"})})})}}()}),Hustle.define("Embedded.Module",function(){"use strict";!function(){if("hustle_page_hustle_embedded_listing"===pagenow)new(Hustle.get("Embedded.Listing"))}(),function(){if("hustle_page_hustle_embedded"===pagenow){var e=Hustle.get("Embedded.View"),t=Hustle.get("Embedded.Content_View"),i=Hustle.get("Embedded.Design_View"),s=Hustle.get("Embedded.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Embedded.Models.Base"),a=Hustle.get("Embedded.Models.Content"),l=Hustle.get("Embedded.Models.Design"),d=Hustle.get("Embedded.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"embedded"})})})}}()}),Hustle.define("SShare.Module",function(e){"use strict";!function(){if("hustle_page_hustle_sshare_listing"===pagenow)new(Hustle.get("SShare.Listing"))}(),function(){if("hustle_page_hustle_sshare"===pagenow&&!parseInt(optin_vars.current.is_ss_limited)){var e=Hustle.get("SShare.View"),t=Hustle.get("SShare.Content_View"),i=Hustle.get("SShare.Design_View"),s=Hustle.get("SShare.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("SShare.Models.Base"),a=Hustle.get("SShare.Models.Content"),l=Hustle.get("SShare.Models.Design"),d=Hustle.get("SShare.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});new e({model:r,content_view:new t({model:c}),design_view:new i({model:_,social_icons:c.get("social_icons"),service_type:c.get("service_type"),click_counter:c.get("click_counter")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"social_sharing"})})})}}()}),Hustle.define("Dashboard.View",function(p,e,t){"use strict";if("toplevel_page_hustle"===pagenow&&!_.isTrue(optin_vars.is_free))new(Backbone.View.extend({el:".wph-dashboard",conversions_chart:null,chart_data:null,chart_options:null,empty_chart:!0,default_dataset_options:{fill:!1,cubicInterpolationMode:"monotone",borderCapStyle:"butt",borderDash:[],borderWidth:1,borderDashOffset:0,borderJoinStyle:"miter",pointBackgroundColor:"#fff",pointBorderWidth:3,pointHoverRadius:5,pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1},events:{"click .wph-icon.i-close":"close","click .wpmudev-box-action":"hide"},initialize:function(e){return _.isEmpty(optin_vars.top_active_modules)||"undefined"==typeof google||(google.charts.load("current",{packages:["corechart","line"]}),google.charts.setOnLoadCallback(this.drawLineStyles)),this.render()},drawLineStyles:function(){var s=new google.visualization.DataTable;s.addColumn("date","Day");var i=[];if(_.each(optin_vars.top_active_modules,function(e,t){s.addColumn("number",e.module_name),i.push(e.color)}),!_.isEmpty(optin_vars.graph_date_conversions)){_.each(optin_vars.graph_date_conversions,function(e,t){var i=[new Date(e.formatted)];_.each(e.conversions,function(e){i.push(e)}),s.addRows([i])});var e={curveType:"function",legend:{position:"none"},animation:{startup:!0,duration:500,easing:"in"},colors:i,pointSize:5,lineWidth:1,interpolateNulls:!0,chartArea:{top:10,right:10,bottom:40,left:40},hAxis:{format:"d MMM",viewWindow:{min:new Date(optin_vars.graph_min_date),max:new Date(optin_vars.graph_max_date)},baseline:new Date(optin_vars.graph_min_date),baselineColor:"#D8D8D8",gridlines:{color:"transparent",count:5},textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},vAxis:{viewWindow:{min:0},gridlines:{color:"#D8D8D8",count:5},baseline:0,baselineColor:"#D8D8D8",textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},tooltip:{showColorCode:!0}};new google.visualization.LineChart(document.getElementById("hustle_chart")).draw(s,e)}},render:function(){p(".hustle-free-version-create").on("click",this.show_upgrade_modal),p(".wpmudev-box-head .wpmudev-icon.wpmudev-i_close").on("click",this.close_modal),p(".tabs-header li label").on("click",this.toggle_overview),p(".can-close .wph-icon.i-close").on("click",this.close),p(".can-hide .wpmudev-box-action").on("click",this.hide),p("a#sshare_view_all_stats").on("click",this.toggle_sshare_modal),p("#wpmudev-dashboard-widget-modules .wpmudev-box-head").on("click",this.toggle_module_accordion),this.handle_sshare_modal_pagination();var e=p("#conversions_chart");if(e.length)if(this.empty_chart){e.parent().css("height","100%").css("width","100%").css("display","table");var t=p('<div class="graph-no-data">'+optin_vars.messages.dashboard.not_enough_data+"</div>");t.css("display","table-cell").css("text-align","center").css("vertical-align","middle"),e.replaceWith(t)}else{var i=e.closest("#wph-module-stats").find("table.wph-table.wph-module--stats").outerHeight();for(var s in 230<i?e.attr("height",i):e.attr("height",230),this.chart_data.datasets)this.chart_data.datasets[s].data&&(this.chart_data.datasets[s].data=_.sortBy(this.chart_data.datasets[s].data,"x"));this.conversions_chart=new Chart(e,{type:"line",data:this.chart_data,options:this.chart_options})}},toggle_module_accordion:function(e){var t=p(e.target),i=t.parents(".wpmudev-box").find(".wpmudev-box-body"),s=t.parents(".wpmudev-box").find(".wpmudev-box-head");i.slideToggle("fast",function(){s.toggleClass("wpmudev-collapsed"),i.toggleClass("wpmudev-hidden")})},close_modal:function(e){e.preventDefault(),p(e.target).closest(".wpmudev-modal").removeClass("wpmudev-modal-active")},close:function(e){e.preventDefault();var t=p(e.target).closest(".wpmudev-row"),i=p(e.target).closest("#wph-welcome").data("nonce");t.slideToggle(300,function(){p.ajax({url:ajaxurl,type:"POST",data:{action:"persist_new_welcome_close",_ajax_nonce:i},complete:function(e){t.remove()}})})},hide:function(e){e.preventDefault(),p(e.target).closest(".wpmudev-box-head").next(".wpmudev-box-body").toggleClass(".wpmudev-hide")},show_upgrade_modal:function(e){void 0!==e&&e.preventDefault(),p("#wph-upgrade-modal").addClass("wpmudev-modal-active")},toggle_overview:function(e){e.preventDefault();var t=p(e.target),i=t.find("input").val(),s=p("#wph-"+i+"-overview"),o=t.parent();p(".wph-modules-overview").not(s).removeClass("current"),s.addClass("current"),p(".tabs-header li").not(o).removeClass("current"),o.addClass("current")},toggle_sshare_modal:function(e){e.preventDefault(),p("#wph-cumulative-shares-modal").addClass("wpmudev-modal-active")},handle_sshare_modal_pagination:function(){p("li.wph-sshare--prev_page a").on("click",p.proxy(this.sshare_modal_prev,this)),p("li.wph-sshare--next_page a").on("click",p.proxy(this.sshare_modal_next,this)),p("li.wph-sshare--page_number a").on("click",p.proxy(this.sshare_modal_goto,this))},sshare_modal_prev:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=p(e.target).closest("li"),i=t.parent(),s=i.data("nonce"),o=i.find("li.wph-sshare--current_page"),n=i.find("li.wph-sshare--page_number"),a=i.find("li.wph-sshare--next_page"),l=(parseInt(i.data("total")),parseInt(o.data("page"))),d=parseInt(t.data("page"));o.data("page",d);var r=a.find("svg");if(a.data("page",l),r.length&&a.html('<a href="#">'+r[0].outerHTML+"</a>"),1==d){var c=t.find("svg");c.length&&t.html("<span>"+c[0].outerHTML+"</span>")}n.length?(n.data("page",l),n.find("a").text(l)):p('<li class="wph-link wph-sshare--page_number" data-page="'+l+'"><a href="#">'+l+"</a></li>").insertAfter(o);o.find("span").text(d),t.data("page",d-1),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(d,s)},sshare_modal_next:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=p(e.target).closest("li"),i=t.parent(),s=i.data("nonce"),o=i.find("li.wph-sshare--current_page"),n=i.find("li.wph-sshare--page_number"),a=i.find("li.wph-sshare--prev_page"),l=parseInt(i.data("total")),d=parseInt(o.data("page")),r=parseInt(t.data("page"));o.data("page",r);var c=a.find("svg");if(a.data("page",d),c.length&&a.html('<a href="#">'+c[0].outerHTML+"</a>"),r<l){if(n.length){var _=r+1;n.data("page",_),n.find("a").text(_),t.data("page",_)}}else{n.length&&n.remove();var u=t.find("svg");u.length&&t.html("<span>"+u[0].outerHTML+"</span>")}o.find("span").text(r),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(r,s)},sshare_modal_goto:function(e){e.preventDefault(),e.stopImmediatePropagation(),p(e.target).closest("li").parent().find("li.wph-sshare--next_page a").click()},sshare_show_page_content:function(e,t){var s=Optin.template("wpmudev-hustle-sshare-stats-modal-tpl"),o=p("#wph-cumulative-shares-modal table.wpmudev-table-paginated tbody");o.html('<div class="wph-sshare--loading_stats"><span class="on-action">Loading...</span></div>'),p.ajax({url:ajaxurl,type:"POST",data:{action:"sshare_show_page_content",page_id:e,_ajax_nonce:t},complete:function(e){var t=e.responseJSON.data,i=s(_.extend({},t));o.html(i)}})}}))}),function(n,e){"use strict";if("hustle_page_hustle_settings"===pagenow){var t=Hustle.get("Settings.Modules_Activity"),i=Hustle.get("Settings.Mail_Settings"),s=Hustle.get("Settings.Unsubscribe_Settings");new t,new i,new s;n(".wpmudev-box .wpmudev-box-head").on("click",function(e){var t=n(e.target),i=t.closest(".wpmudev-box").children(".wpmudev-box-body"),s=t.closest(".wpmudev-box").children(".wpmudev-box-head");i.slideToggle("fast",function(){s.toggleClass("wpmudev-collapsed"),i.toggleClass("wpmudev-hidden")})}),n("#wpmudev-settings-widget-unsubscribe .toggle-checkbox").on("change",function(e){var t=n(e.target),i=t.closest(".wpmudev-switch-labeled").next(".wpmudev-box-gray"),s=t.closest("form"),o="wpmudev-settings-unsubscribe-messages"===s.attr("id")?"hustle_toggle_unsubscribe_messages_settings":"hustle_toggle_unsubscribe_email_settings";t.prop("checked")?i.removeClass("wpmudev-hidden"):i.addClass("wpmudev-hidden"),n.ajax({url:ajaxurl,type:"POST",data:{action:o,enabled:t.prop("checked"),_ajax_nonce:s.data("nonce")},success:function(){}})})}}(jQuery,document);
//# sourceMappingURL=maps/admin.min.js.map
